<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Munir (23202537), Farihah (23202679), Sanggary (23202894), Khairunnisa (23202532)">
<meta name="dcterms.date" content="2026-01-03">

<title>Linear Regression on Quality of Life</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Linear CA_edited_030126_files/libs/clipboard/clipboard.min.js"></script>
<script src="Linear CA_edited_030126_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Linear CA_edited_030126_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Linear CA_edited_030126_files/libs/quarto-html/popper.min.js"></script>
<script src="Linear CA_edited_030126_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Linear CA_edited_030126_files/libs/quarto-html/anchor.min.js"></script>
<link href="Linear CA_edited_030126_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Linear CA_edited_030126_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Linear CA_edited_030126_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Linear CA_edited_030126_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Linear CA_edited_030126_files/libs/bootstrap/bootstrap-7f5740c09e508315c41a07c582dff588.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#part-a-research-question-dataset-and-variable-creation" id="toc-part-a-research-question-dataset-and-variable-creation" class="nav-link active" data-scroll-target="#part-a-research-question-dataset-and-variable-creation"><span class="header-section-number">1</span> Part A: Research question, dataset and variable creation</a>
  <ul class="collapse">
  <li><a href="#research-question-objective" id="toc-research-question-objective" class="nav-link" data-scroll-target="#research-question-objective"><span class="header-section-number">1.1</span> Research Question / Objective</a></li>
  <li><a href="#data-simulation" id="toc-data-simulation" class="nav-link" data-scroll-target="#data-simulation"><span class="header-section-number">1.2</span> Data simulation</a></li>
  <li><a href="#data-preparation--glimpse-the-generated-data" id="toc-data-preparation--glimpse-the-generated-data" class="nav-link" data-scroll-target="#data-preparation--glimpse-the-generated-data"><span class="header-section-number">1.3</span> Data Preparation- Glimpse the generated data</a>
  <ul class="collapse">
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.3.1</span> Load libraries</a></li>
  <li><a href="#data-structure-and-exploration" id="toc-data-structure-and-exploration" class="nav-link" data-scroll-target="#data-structure-and-exploration"><span class="header-section-number">1.3.2</span> Data structure and exploration</a></li>
  <li><a href="#label-variables" id="toc-label-variables" class="nav-link" data-scroll-target="#label-variables"><span class="header-section-number">1.3.3</span> Label variables</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-b-exploratory-data-analysis" id="toc-part-b-exploratory-data-analysis" class="nav-link" data-scroll-target="#part-b-exploratory-data-analysis"><span class="header-section-number">2</span> Part B: Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">2.1</span> Descriptive statistics</a></li>
  <li><a href="#visualizations" id="toc-visualizations" class="nav-link" data-scroll-target="#visualizations"><span class="header-section-number">2.2</span> Visualizations</a>
  <ul class="collapse">
  <li><a href="#histograms-for-continuous-variables" id="toc-histograms-for-continuous-variables" class="nav-link" data-scroll-target="#histograms-for-continuous-variables"><span class="header-section-number">2.2.1</span> Histograms for Continuous Variables</a></li>
  <li><a href="#box-plots-by-categorical-variable-obesity" id="toc-box-plots-by-categorical-variable-obesity" class="nav-link" data-scroll-target="#box-plots-by-categorical-variable-obesity"><span class="header-section-number">2.2.2</span> Box Plots by Categorical Variable (Obesity)</a></li>
  <li><a href="#scatter-plots-qol-vs.-predictors" id="toc-scatter-plots-qol-vs.-predictors" class="nav-link" data-scroll-target="#scatter-plots-qol-vs.-predictors"><span class="header-section-number">2.2.3</span> Scatter Plots (QoL vs.&nbsp;Predictors)</a></li>
  <li><a href="#correlation-matrix" id="toc-correlation-matrix" class="nav-link" data-scroll-target="#correlation-matrix"><span class="header-section-number">2.2.4</span> Correlation Matrix</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-c-regression-analysis" id="toc-part-c-regression-analysis" class="nav-link" data-scroll-target="#part-c-regression-analysis"><span class="header-section-number">3</span> Part C: Regression Analysis</a>
  <ul class="collapse">
  <li><a href="#univariable-analysis" id="toc-univariable-analysis" class="nav-link" data-scroll-target="#univariable-analysis"><span class="header-section-number">3.1</span> Univariable analysis</a>
  <ul class="collapse">
  <li><a href="#years-of-working" id="toc-years-of-working" class="nav-link" data-scroll-target="#years-of-working"><span class="header-section-number">3.1.1</span> Years of working</a></li>
  <li><a href="#physical-activity" id="toc-physical-activity" class="nav-link" data-scroll-target="#physical-activity"><span class="header-section-number">3.1.2</span> Physical activity</a></li>
  <li><a href="#obesity" id="toc-obesity" class="nav-link" data-scroll-target="#obesity"><span class="header-section-number">3.1.3</span> Obesity</a></li>
  </ul></li>
  <li><a href="#handling-potential-confounder" id="toc-handling-potential-confounder" class="nav-link" data-scroll-target="#handling-potential-confounder"><span class="header-section-number">3.2</span> Handling potential confounder</a></li>
  <li><a href="#multivariable-analysis" id="toc-multivariable-analysis" class="nav-link" data-scroll-target="#multivariable-analysis"><span class="header-section-number">3.3</span> Multivariable analysis</a>
  <ul class="collapse">
  <li><a href="#model-1-full-model-main-effects-only." id="toc-model-1-full-model-main-effects-only." class="nav-link" data-scroll-target="#model-1-full-model-main-effects-only."><span class="header-section-number">3.3.1</span> model 1: full model (main effects only).</a></li>
  <li><a href="#model-2-full-model-interaction-between-physical-activity-and-obesity." id="toc-model-2-full-model-interaction-between-physical-activity-and-obesity." class="nav-link" data-scroll-target="#model-2-full-model-interaction-between-physical-activity-and-obesity."><span class="header-section-number">3.3.2</span> model 2: full model + interaction between physical activity and obesity.</a></li>
  </ul></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><span class="header-section-number">3.4</span> Model comparison</a></li>
  </ul></li>
  <li><a href="#part-d-model-checking" id="toc-part-d-model-checking" class="nav-link" data-scroll-target="#part-d-model-checking"><span class="header-section-number">4</span> Part D: Model Checking</a>
  <ul class="collapse">
  <li><a href="#check-assumptions" id="toc-check-assumptions" class="nav-link" data-scroll-target="#check-assumptions"><span class="header-section-number">4.1</span> Check assumptions</a>
  <ul class="collapse">
  <li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity"><span class="header-section-number">4.1.1</span> Linearity</a></li>
  <li><a href="#normality-of-residuals" id="toc-normality-of-residuals" class="nav-link" data-scroll-target="#normality-of-residuals"><span class="header-section-number">4.1.2</span> Normality of residuals</a></li>
  <li><a href="#homocedasticity-scale-location" id="toc-homocedasticity-scale-location" class="nav-link" data-scroll-target="#homocedasticity-scale-location"><span class="header-section-number">4.1.3</span> Homocedasticity (Scale-Location)</a></li>
  <li><a href="#independence-of-residues" id="toc-independence-of-residues" class="nav-link" data-scroll-target="#independence-of-residues"><span class="header-section-number">4.1.4</span> Independence of residues</a></li>
  </ul></li>
  <li><a href="#influential-analysis" id="toc-influential-analysis" class="nav-link" data-scroll-target="#influential-analysis"><span class="header-section-number">4.2</span> Influential Analysis</a>
  <ul class="collapse">
  <li><a href="#cooks-distance" id="toc-cooks-distance" class="nav-link" data-scroll-target="#cooks-distance"><span class="header-section-number">4.2.1</span> Cook’s Distance</a></li>
  <li><a href="#leverage-points" id="toc-leverage-points" class="nav-link" data-scroll-target="#leverage-points"><span class="header-section-number">4.2.2</span> Leverage Points</a></li>
  <li><a href="#dfbetas" id="toc-dfbetas" class="nav-link" data-scroll-target="#dfbetas"><span class="header-section-number">4.2.3</span> DFBETAS</a></li>
  </ul></li>
  <li><a href="#remedial-measures" id="toc-remedial-measures" class="nav-link" data-scroll-target="#remedial-measures"><span class="header-section-number">4.3</span> Remedial Measures</a>
  <ul class="collapse">
  <li><a href="#remove-influential-observations-and-refit-the-model" id="toc-remove-influential-observations-and-refit-the-model" class="nav-link" data-scroll-target="#remove-influential-observations-and-refit-the-model"><span class="header-section-number">4.3.1</span> Remove influential observations and refit the model</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-e-results-presentation-and-interpretation" id="toc-part-e-results-presentation-and-interpretation" class="nav-link" data-scroll-target="#part-e-results-presentation-and-interpretation"><span class="header-section-number">5</span> Part E: Results Presentation and Interpretation</a>
  <ul class="collapse">
  <li><a href="#final-regression-table" id="toc-final-regression-table" class="nav-link" data-scroll-target="#final-regression-table"><span class="header-section-number">5.1</span> Final regression table</a></li>
  <li><a href="#final-model-equation" id="toc-final-model-equation" class="nav-link" data-scroll-target="#final-model-equation"><span class="header-section-number">5.2</span> Final model equation</a></li>
  <li><a href="#interaction-plot" id="toc-interaction-plot" class="nav-link" data-scroll-target="#interaction-plot"><span class="header-section-number">5.3</span> Interaction Plot</a></li>
  <li><a href="#interpretation-of-final-model-results" id="toc-interpretation-of-final-model-results" class="nav-link" data-scroll-target="#interpretation-of-final-model-results"><span class="header-section-number">5.4</span> Interpretation of Final Model Results</a>
  <ul class="collapse">
  <li><a href="#main-effects-and-interaction-terms" id="toc-main-effects-and-interaction-terms" class="nav-link" data-scroll-target="#main-effects-and-interaction-terms"><span class="header-section-number">5.4.1</span> Main Effects and Interaction Terms</a></li>
  <li><a href="#model-comparison-1" id="toc-model-comparison-1" class="nav-link" data-scroll-target="#model-comparison-1"><span class="header-section-number">5.4.2</span> Model Comparison</a></li>
  <li><a href="#practical-significance" id="toc-practical-significance" class="nav-link" data-scroll-target="#practical-significance"><span class="header-section-number">5.4.3</span> Practical Significance</a></li>
  <li><a href="#model-assumptions-and-diagnostics" id="toc-model-assumptions-and-diagnostics" class="nav-link" data-scroll-target="#model-assumptions-and-diagnostics"><span class="header-section-number">5.4.4</span> Model Assumptions and Diagnostics</a></li>
  <li><a href="#influential-observations-and-their-impact-on-model-prediction" id="toc-influential-observations-and-their-impact-on-model-prediction" class="nav-link" data-scroll-target="#influential-observations-and-their-impact-on-model-prediction"><span class="header-section-number">5.4.5</span> Influential Observations and their impact on model prediction:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="header-section-number">6</span> Prediction</a>
  <ul class="collapse">
  <li><a href="#new-data-simulation" id="toc-new-data-simulation" class="nav-link" data-scroll-target="#new-data-simulation"><span class="header-section-number">6.1</span> New data simulation</a></li>
  <li><a href="#fitted-values" id="toc-fitted-values" class="nav-link" data-scroll-target="#fitted-values"><span class="header-section-number">6.2</span> Fitted values</a></li>
  <li><a href="#prediction-visualization" id="toc-prediction-visualization" class="nav-link" data-scroll-target="#prediction-visualization"><span class="header-section-number">6.3</span> Prediction visualization</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">7</span> Conclusion</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Linear Regression on Quality of Life</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Linear Regression</div>
    <div class="quarto-category">Medical Statistics</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Munir (23202537), Farihah (23202679), Sanggary (23202894), Khairunnisa (23202532) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 3, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="part-a-research-question-dataset-and-variable-creation" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Part A: Research question, dataset and variable creation</h1>
<section id="research-question-objective" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="research-question-objective"><span class="header-section-number">1.1</span> Research Question / Objective</h2>
<p>To study the association between physical activity, obesity, years of working, and the quality of life among adults.</p>
<p>Specifically, we aim to:</p>
<ol type="1">
<li>Assess the individual effects of physical activity, obesity, and years of working on quality of life.</li>
<li>Investigate potential interaction effects between physical activity and obesity on quality of life.</li>
<li>Control for confounding factors and evaluate model fit and assumptions.</li>
</ol>
</section>
<section id="data-simulation" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="data-simulation"><span class="header-section-number">1.2</span> Data simulation</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.helpers)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Set seed for reproducibility</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Define sample size</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Generate Covariates</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Years working: Uniform distribution between 0 and 40</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>years_working <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">40</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Physical activity: Uniform distribution between 0 and 10</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>phys_activity <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Obesity: Binary (0 = not obese, 1 = obese) with 30% prevalence</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>obesity_binary <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.3</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>obesity <span class="ot">&lt;-</span> <span class="fu">factor</span>(obesity_binary, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Define Coefficients (True Population Parameters)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="dv">50</span>          <span class="co"># Intercept (Base QoL)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.2</span>        <span class="co"># Effect of years_working (slight decline over time)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="ot">&lt;-</span> <span class="fl">3.5</span>         <span class="co"># Effect of phys_activity (positive impact)</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>beta_3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span>         <span class="co"># Effect of obesity (negative impact)</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>beta_4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.5</span>        <span class="co"># Interaction: Benefit of phys_activity is reduced by 1.5 if obese</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Calculate Outcome (Quality of Life)</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Formula: Y = b0 + b1*X1 + b2*X2 + b3*X3 + b4*(X2*X3) + error</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># Random error</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>qol_raw <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  (beta_1 <span class="sc">*</span> years_working) <span class="sc">+</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  (beta_2 <span class="sc">*</span> phys_activity) <span class="sc">+</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  (beta_3 <span class="sc">*</span> obesity_binary) <span class="sc">+</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  (beta_4 <span class="sc">*</span> phys_activity <span class="sc">*</span> obesity_binary) <span class="sc">+</span> <span class="co"># The Interaction Term</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  noise</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Enforce Bounds (0-100)</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate values to ensure they stay within the scale</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>qol <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(<span class="dv">100</span>, qol_raw))</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Create Dataframe</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">qol =</span> <span class="fu">round</span>(qol, <span class="dv">1</span>),</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">round</span>(years_working, <span class="dv">1</span>),</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">round</span>(phys_activity, <span class="dv">1</span>),</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> obesity</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Generate QoL dataset (n=200) with:</p>
<ul>
<li>ranges: qol 0-100, years_working 0-40, phys_activity 0-10</li>
<li>obesity as factor with 2 levels</li>
<li>interaction: phys_activity * obesity</li>
</ul>
</section>
<section id="data-preparation--glimpse-the-generated-data" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="data-preparation--glimpse-the-generated-data"><span class="header-section-number">1.3</span> Data Preparation- Glimpse the generated data</h2>
<section id="load-libraries" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="load-libraries"><span class="header-section-number">1.3.1</span> Load libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-structure-and-exploration" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="data-structure-and-exploration"><span class="header-section-number">1.3.2</span> Data structure and exploration</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 200
Columns: 5
$ id            &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
$ qol           &lt;dbl&gt; 38.9, 73.6, 44.1, 55.7, 54.4, 82.1, 33.0, 54.0, 57.7, 62…
$ years_working &lt;dbl&gt; 11.5, 31.5, 16.4, 35.3, 37.6, 1.8, 21.1, 35.7, 22.1, 18.…
$ phys_activity &lt;dbl&gt; 2.4, 9.6, 6.0, 5.2, 4.0, 8.8, 3.6, 2.9, 1.7, 1.7, 4.8, 2…
$ obesity       &lt;fct&gt; obese, not obese, obese, not obese, not obese, not obese…</code></pre>
</div>
</div>
<p><em>Interpretation</em> : The structure of the data shows that ‘years_working’, ‘phys_activity’ and ‘quality of life’ are numeric variables while ‘obesity’ is a factor with two levels.</p>
</section>
<section id="label-variables" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="label-variables"><span class="header-section-number">1.3.3</span> Label variables</h3>
<p>The variables were labeled for clarity as follows: years_working as “Years of Working”, phys_activity as “Physical Activity Score”, obesity as “Obesity Status”, and qol as “Quality of Life”.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>years_working) <span class="ot">&lt;-</span> <span class="st">"Years of Working"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>phys_activity) <span class="ot">&lt;-</span> <span class="st">"Physical Activity Score"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>obesity) <span class="ot">&lt;-</span> <span class="st">"Obesity Status"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>qol) <span class="ot">&lt;-</span> <span class="st">"Quality of Life"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="part-b-exploratory-data-analysis" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Part B: Exploratory Data Analysis</h1>
<section id="descriptive-statistics" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">2.1</span> Descriptive statistics</h2>
<p>We inspect the central tendency and dispersion of the variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#descriptive analysis</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(df[,<span class="fu">c</span>(<span class="st">"qol"</span>,<span class="st">"years_working"</span>,<span class="st">"phys_activity"</span>,<span class="st">"obesity"</span>)],  </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">style        =</span> <span class="st">"grid"</span>,  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">varnumbers   =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">valid.col    =</span> <span class="cn">FALSE</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">method =</span> <span class="st">"render"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="container st-container">
<h3 class="anchored">Data Frame Summary</h3>
<h4 class="anchored">df</h4>
<strong>Dimensions</strong>: 200 x 4
  <br><strong>Duplicates</strong>: 0
<br>

<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline caption-top table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Variable</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Label</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Stats / Values</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Freqs (% of Valid)</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Graph</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Missing</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">qol [numeric]</td>
<td style="text-align: left;">Quality of Life</td>
<td style="text-align: left; padding: 8; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">Mean (sd) : 58.1 (13.7)</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">min ≤ med ≤ max:</td>
</tr>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">26.8 ≤ 55.7 ≤ 90.2</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">IQR (CV) : 21.7 (0.2)</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; vertical-align: middle;">164 distinct values</td>
<td style="text-align: left; vertical-align: middle; padding: 0; background-color: transparent;"><img src="data:image/png;base64,%20iVBORw0KGgoAAAANSUhEUgAAAJgAAABuBAMAAAApJ8cWAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAPUExURf////3+/aampvDw8P///7GHRIEAAAACdFJOUwAAdpPNOAAAAAFiS0dEAIgFHUgAAAAHdElNRQfqAQMPAiUmsOXiAAAAi0lEQVRo3u3ZwQ2AIAxAUVbADYQNZP/dPEh70DRFyon8fzIhfTaeSEyJZspmRcp+Llbb0xXADlloCdaNBgYGBgYGBgYGBrYNNnCHH8eav+JWmHy7cwUmD2BgYGBgYGBgYGHse8kNYHpiYvq6FVg1R8DAwMDAwHysfP6N/sB0uGPVnB3A9OS9WahEM91m03ytLfZBFAAAAABJRU5ErkJggg==" class="img-fluid" style="border:none;background-color:transparent;padding:0;max-width:max-content;"></td>
<td style="text-align: center;">0 (0.0%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">years_working [numeric]</td>
<td style="text-align: left;">Years of Working</td>
<td style="text-align: left; padding: 8; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">Mean (sd) : 20.3 (11)</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">min ≤ med ≤ max:</td>
</tr>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">0 ≤ 19.3 ≤ 39.8</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">IQR (CV) : 18.5 (0.5)</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; vertical-align: middle;">151 distinct values</td>
<td style="text-align: left; vertical-align: middle; padding: 0; background-color: transparent;"><img src="data:image/png;base64,%20iVBORw0KGgoAAAANSUhEUgAAAJgAAABuBAMAAAApJ8cWAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAPUExURf////3+/aampvDw8P///7GHRIEAAAACdFJOUwAAdpPNOAAAAAFiS0dEAIgFHUgAAAAHdElNRQfqAQMPAiUmsOXiAAAAiElEQVRo3u3WQQqAIBBAUa9QN0hv4Nz/bi1qXChToQMl/b8xVB4EJoVAPS1a1MyJi2osyVE2J8DAvorpwb/H1vKRmNg5ygNMt+aXsfJWmwemK2ATY+Wce2BSP4CBgf0Aa66REaxdAQMD88Zi8z88gCVzBxgYGBgYGBgYGBgYGBgY2LRYdClQTztxmNQKSOdIrAAAAABJRU5ErkJggg==" class="img-fluid" style="border:none;background-color:transparent;padding:0;max-width:max-content;"></td>
<td style="text-align: center;">0 (0.0%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">phys_activity [numeric]</td>
<td style="text-align: left;">Physical Activity Score</td>
<td style="text-align: left; padding: 8; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">Mean (sd) : 4.9 (2.9)</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">min ≤ med ≤ max:</td>
</tr>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">0.1 ≤ 4.7 ≤ 10</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">IQR (CV) : 5.1 (0.6)</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; vertical-align: middle;">86 distinct values</td>
<td style="text-align: left; vertical-align: middle; padding: 0; background-color: transparent;"><img src="data:image/png;base64,%20iVBORw0KGgoAAAANSUhEUgAAAJgAAABuBAMAAAApJ8cWAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAPUExURf////3+/aampvDw8P///7GHRIEAAAACdFJOUwAAdpPNOAAAAAFiS0dEAIgFHUgAAAAHdElNRQfqAQMPAiUmsOXiAAAAiElEQVRo3u3UQQqAIBCFYa9gN8hukPe/W5DT4kWYqBTo/zbDKH6LYdA5UhP/lJCy+tLksC2eAZsa05WyrhbTd9aBLTbWPli62qfCrgn2wawDGxfTj0wPdaUKsEy5vQMDAwP7H9PfrRHTMgKm42nE4nsBAwMDAwMDAwMDAwMDAwMD+x4LXeJITQ7SOLEt3SuxQwAAAABJRU5ErkJggg==" class="img-fluid" style="border:none;background-color:transparent;padding:0;max-width:max-content;"></td>
<td style="text-align: center;">0 (0.0%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">obesity [factor]</td>
<td style="text-align: left;">Obesity Status</td>
<td style="text-align: left; padding: 8; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">1. not obese</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">2. obese</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; padding: 0; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: right; padding: 0 5px 0 7px; margin: 0; border: 0;">139</td>
<td style="text-align: left; padding: 0 2px 0 0; border: 0;">(</td>
<td style="text-align: right; padding: 0; border: 0;">69.5%</td>
<td style="text-align: left; padding: 0 4px 0 2px; border: 0;">)</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: right; padding: 0 5px 0 7px; margin: 0; border: 0;">61</td>
<td style="text-align: left; padding: 0 2px 0 0; border: 0;">(</td>
<td style="text-align: right; padding: 0; border: 0;">30.5%</td>
<td style="text-align: left; padding: 0 4px 0 2px; border: 0;">)</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; vertical-align: middle; padding: 0; background-color: transparent;"><img src="data:image/png;base64,%20iVBORw0KGgoAAAANSUhEUgAAAHUAAAA3BAMAAADAuhjoAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAPUExURf////3+/aampvDw8P///7GHRIEAAAACdFJOUwAAdpPNOAAAAAFiS0dEAIgFHUgAAAAHdElNRQfqAQMPAiUmsOXiAAAAQ0lEQVRIx2NgGHlAiQygANWrbEw6GNU7qndU76jegdBLSVknSAYQGGC9OLxElF7s4Ww0qndU76jeUb2DTi8lZd1IAgAArXVGbM4VjgAAAABJRU5ErkJggg==" class="img-fluid" style="border:none;background-color:transparent;padding:0;max-width:max-content;"></td>
<td style="text-align: center;">0 (0.0%)</td>
</tr>
</tbody>
</table>

<p>Generated by <a href="https://github.com/dcomtois/summarytools">summarytools</a> 1.1.4 (<a href="https://www.r-project.org/">R</a> version 4.5.2)<br>2026-01-03</p>
</div>
</div>
</div>
<p><em>Interpretation</em> : Outcome Variable (Quality of Life):</p>
<p>The average Quality of Life (QOL) score is 58.1 (<span class="math inline">\(SD = 13.7\)</span>), ranging from a low of 26.8 to a high of 90.2. The graph suggests the scores are relatively normally distributed (bell-shaped) around the mean.</p>
<p>Continuous Predictors:</p>
<p>Years Working: Participants have worked for an average of 20.3 years (<span class="math inline">\(SD = 11.0\)</span>), spanning a full range from new entrants (0 years) to those with near-maximum tenure (39.8 years). The small histogram shows a fairly flat (uniform) distribution, meaning there is a good mix of people with different experience levels.</p>
<p>Physical Activity: The mean physical activity score is 4.9 (<span class="math inline">\(SD = 2.9\)</span>) on a scale of 0–10. Similar to years working, this variable covers the full range (0.1 to 10) and is widely distributed.</p>
<p>Categorical Predictor :</p>
<p>Obesity:The sample is predominantly non-obese, with 69.5% (<span class="math inline">\(n=139\)</span>) classified as “not obese” and 30.5% (<span class="math inline">\(n=61\)</span>) classified as “obese.” This provides a sufficient sample size in both groups to compare differences.</p>
</section>
<section id="visualizations" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="visualizations"><span class="header-section-number">2.2</span> Visualizations</h2>
<section id="histograms-for-continuous-variables" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="histograms-for-continuous-variables"><span class="header-section-number">2.2.1</span> Histograms for Continuous Variables</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(qol, years_working, phys_activity) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Value)) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histograms of Continuous Variables"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/histograms-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Distribution of Continuous Variables</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : The Physical Activity score and years of working exhibit approximately symmetric distributions. In contrast, the QoL scores demonstrate a pronounced right skew (concentration of values at the lower end). This skewness suggests that while most participants reported moderate quality of life, some participants have relatively good quality of life.</p>
</section>
<section id="box-plots-by-categorical-variable-obesity" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="box-plots-by-categorical-variable-obesity"><span class="header-section-number">2.2.2</span> Box Plots by Categorical Variable (Obesity)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(obesity, qol, years_working, phys_activity) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>obesity, <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">y =</span> Value, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variable, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plots by Obesity Status"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/boxplots-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Box Plots by Obesity Status</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : The box plot confirms a distinct separation between groups specifically in quality of life subgroup. The non-obese group exhibits a substantially higher median and elevated interquartile range compared to the obese group. However, there are no noticeable difference in the physical activity and years of working subgroups (overlapped box plots)</p>
</section>
<section id="scatter-plots-qol-vs.-predictors" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="scatter-plots-qol-vs.-predictors"><span class="header-section-number">2.2.3</span> Scatter Plots (QoL vs.&nbsp;Predictors)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QoL vs Years Working</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> years_working, <span class="at">y =</span> qol)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QoL vs Years Working"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># QoL vs Physical Activity (colored by Obesity to see interaction)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> phys_activity, <span class="at">y =</span> qol)) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QoL vs Physical Activity "</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/scatterplots-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Relationships between Continuous Variables</figcaption>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/scatterplots-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Relationships between Continuous Variables</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : Years working shows a negative correlation with QOL , while physical activity shows a positive linear relationship.</p>
</section>
<section id="correlation-matrix" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="correlation-matrix"><span class="header-section-number">2.2.4</span> Correlation Matrix</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only numeric columns</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(qol, years_working, phys_activity)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Correlation Matrix</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/correlation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Correlation Matrix</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : Strong Positive Relationship: There is a strong, highly significant correlation (0.718) between phys_activity and qol. This indicates that as physical activity increases, Quality of Life scores tend to rise substantially.</p>
<p>Weak Negative Relationship: There is a weak negative correlation (-0.139) between years_working and qol. This suggests that longer work duration is associated with a slight decrease in Quality of Life, though the relationship is not very strong.</p>
<p>Independence of Predictors: The correlation between years_working and phys_activity is negligible (-0.052). This confirms that there is no linear relationship between these two independent variables, meaning multicollinearity is not a concern for the regression model.</p>
</section>
</section>
</section>
<section id="part-c-regression-analysis" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Part C: Regression Analysis</h1>
<section id="univariable-analysis" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="univariable-analysis"><span class="header-section-number">3.1</span> Univariable analysis</h2>
<p>We first assess the individual association of each predictor with QOL.</p>
<section id="years-of-working" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="years-of-working"><span class="header-section-number">3.1.1</span> Years of working</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mod_year <span class="ot">&lt;-</span><span class="fu">lm</span>(qol<span class="sc">~</span> years_working, <span class="at">data=</span> df)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_year, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 1: Univariable Model - Years of Working"</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="mhbfwqngmh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mhbfwqngmh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mhbfwqngmh thead, #mhbfwqngmh tbody, #mhbfwqngmh tfoot, #mhbfwqngmh tr, #mhbfwqngmh td, #mhbfwqngmh th {
  border-style: none;
}

#mhbfwqngmh p {
  margin: 0;
  padding: 0;
}

#mhbfwqngmh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mhbfwqngmh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mhbfwqngmh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mhbfwqngmh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mhbfwqngmh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhbfwqngmh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhbfwqngmh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhbfwqngmh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mhbfwqngmh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mhbfwqngmh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mhbfwqngmh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mhbfwqngmh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mhbfwqngmh .gt_spanner_row {
  border-bottom-style: hidden;
}

#mhbfwqngmh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mhbfwqngmh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mhbfwqngmh .gt_from_md > :first-child {
  margin-top: 0;
}

#mhbfwqngmh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mhbfwqngmh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mhbfwqngmh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mhbfwqngmh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mhbfwqngmh .gt_row_group_first td {
  border-top-width: 2px;
}

#mhbfwqngmh .gt_row_group_first th {
  border-top-width: 2px;
}

#mhbfwqngmh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhbfwqngmh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mhbfwqngmh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mhbfwqngmh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhbfwqngmh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhbfwqngmh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mhbfwqngmh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mhbfwqngmh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mhbfwqngmh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhbfwqngmh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhbfwqngmh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhbfwqngmh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhbfwqngmh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhbfwqngmh .gt_left {
  text-align: left;
}

#mhbfwqngmh .gt_center {
  text-align: center;
}

#mhbfwqngmh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mhbfwqngmh .gt_font_normal {
  font-weight: normal;
}

#mhbfwqngmh .gt_font_bold {
  font-weight: bold;
}

#mhbfwqngmh .gt_font_italic {
  font-style: italic;
}

#mhbfwqngmh .gt_super {
  font-size: 65%;
}

#mhbfwqngmh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mhbfwqngmh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mhbfwqngmh .gt_indent_1 {
  text-indent: 5px;
}

#mhbfwqngmh .gt_indent_2 {
  text-indent: 10px;
}

#mhbfwqngmh .gt_indent_3 {
  text-indent: 15px;
}

#mhbfwqngmh .gt_indent_4 {
  text-indent: 20px;
}

#mhbfwqngmh .gt_indent_5 {
  text-indent: 25px;
}

#mhbfwqngmh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mhbfwqngmh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 1: Univariable Model - Years of Working</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">62</td>
<td class="gt_row gt_center" headers="conf.low">58, 66</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Years of Working</td>
<td class="gt_row gt_center" headers="estimate">-0.17</td>
<td class="gt_row gt_center" headers="conf.low">-0.35, 0.00</td>
<td class="gt_row gt_center" headers="p.value">0.050</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="physical-activity" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="physical-activity"><span class="header-section-number">3.1.2</span> Physical activity</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mod_pa<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity, <span class="at">data=</span> df)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_pa, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 2: Univariable Model - Physical Activity"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="yzteiscbwl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yzteiscbwl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yzteiscbwl thead, #yzteiscbwl tbody, #yzteiscbwl tfoot, #yzteiscbwl tr, #yzteiscbwl td, #yzteiscbwl th {
  border-style: none;
}

#yzteiscbwl p {
  margin: 0;
  padding: 0;
}

#yzteiscbwl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yzteiscbwl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yzteiscbwl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yzteiscbwl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yzteiscbwl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzteiscbwl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzteiscbwl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzteiscbwl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yzteiscbwl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yzteiscbwl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yzteiscbwl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yzteiscbwl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yzteiscbwl .gt_spanner_row {
  border-bottom-style: hidden;
}

#yzteiscbwl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yzteiscbwl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yzteiscbwl .gt_from_md > :first-child {
  margin-top: 0;
}

#yzteiscbwl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yzteiscbwl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yzteiscbwl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yzteiscbwl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yzteiscbwl .gt_row_group_first td {
  border-top-width: 2px;
}

#yzteiscbwl .gt_row_group_first th {
  border-top-width: 2px;
}

#yzteiscbwl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzteiscbwl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yzteiscbwl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yzteiscbwl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzteiscbwl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzteiscbwl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yzteiscbwl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yzteiscbwl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yzteiscbwl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzteiscbwl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzteiscbwl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzteiscbwl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzteiscbwl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzteiscbwl .gt_left {
  text-align: left;
}

#yzteiscbwl .gt_center {
  text-align: center;
}

#yzteiscbwl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yzteiscbwl .gt_font_normal {
  font-weight: normal;
}

#yzteiscbwl .gt_font_bold {
  font-weight: bold;
}

#yzteiscbwl .gt_font_italic {
  font-style: italic;
}

#yzteiscbwl .gt_super {
  font-size: 65%;
}

#yzteiscbwl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yzteiscbwl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yzteiscbwl .gt_indent_1 {
  text-indent: 5px;
}

#yzteiscbwl .gt_indent_2 {
  text-indent: 10px;
}

#yzteiscbwl .gt_indent_3 {
  text-indent: 15px;
}

#yzteiscbwl .gt_indent_4 {
  text-indent: 20px;
}

#yzteiscbwl .gt_indent_5 {
  text-indent: 25px;
}

#yzteiscbwl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yzteiscbwl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 2: Univariable Model - Physical Activity</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">42</td>
<td class="gt_row gt_center" headers="conf.low">39, 44</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Physical Activity Score</td>
<td class="gt_row gt_center" headers="estimate">3.4</td>
<td class="gt_row gt_center" headers="conf.low">2.9, 3.8</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="obesity" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="obesity"><span class="header-section-number">3.1.3</span> Obesity</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod_obs<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> obesity, <span class="at">data=</span> df)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_obs, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 3: Univariable Model - Obesity"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="jiensapfth" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jiensapfth table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jiensapfth thead, #jiensapfth tbody, #jiensapfth tfoot, #jiensapfth tr, #jiensapfth td, #jiensapfth th {
  border-style: none;
}

#jiensapfth p {
  margin: 0;
  padding: 0;
}

#jiensapfth .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jiensapfth .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jiensapfth .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jiensapfth .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jiensapfth .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jiensapfth .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jiensapfth .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jiensapfth .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jiensapfth .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jiensapfth .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jiensapfth .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jiensapfth .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jiensapfth .gt_spanner_row {
  border-bottom-style: hidden;
}

#jiensapfth .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jiensapfth .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jiensapfth .gt_from_md > :first-child {
  margin-top: 0;
}

#jiensapfth .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jiensapfth .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jiensapfth .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jiensapfth .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jiensapfth .gt_row_group_first td {
  border-top-width: 2px;
}

#jiensapfth .gt_row_group_first th {
  border-top-width: 2px;
}

#jiensapfth .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jiensapfth .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jiensapfth .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jiensapfth .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jiensapfth .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jiensapfth .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jiensapfth .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jiensapfth .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jiensapfth .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jiensapfth .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jiensapfth .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jiensapfth .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jiensapfth .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jiensapfth .gt_left {
  text-align: left;
}

#jiensapfth .gt_center {
  text-align: center;
}

#jiensapfth .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jiensapfth .gt_font_normal {
  font-weight: normal;
}

#jiensapfth .gt_font_bold {
  font-weight: bold;
}

#jiensapfth .gt_font_italic {
  font-style: italic;
}

#jiensapfth .gt_super {
  font-size: 65%;
}

#jiensapfth .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jiensapfth .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jiensapfth .gt_indent_1 {
  text-indent: 5px;
}

#jiensapfth .gt_indent_2 {
  text-indent: 10px;
}

#jiensapfth .gt_indent_3 {
  text-indent: 15px;
}

#jiensapfth .gt_indent_4 {
  text-indent: 20px;
}

#jiensapfth .gt_indent_5 {
  text-indent: 25px;
}

#jiensapfth .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jiensapfth div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 3: Univariable Model - Obesity</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">63</td>
<td class="gt_row gt_center" headers="conf.low">61, 65</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Obesity Status</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" headers="estimate">-17</td>
<td class="gt_row gt_center" headers="conf.low">-20, -14</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p><em>Interpretation</em> : Physical activity and obesity status are significantly associated with QOL(p values: &lt;0.05). Whereas years of working is marginally related to quality of life (p value:0.05).</p>
</section>
</section>
<section id="handling-potential-confounder" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="handling-potential-confounder"><span class="header-section-number">3.2</span> Handling potential confounder</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mod_pa<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity, <span class="at">data=</span> df)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>mod_pa_years<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity <span class="sc">+</span> years_working, <span class="at">data=</span> df)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>mod_pa_obs<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity <span class="sc">+</span> obesity, <span class="at">data=</span> df)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>coef_pa <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod_pa)<span class="sc">$</span>estimate[<span class="dv">2</span>]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>coef_pa_years <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod_pa_years)<span class="sc">$</span>estimate[<span class="dv">2</span>]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>coef_pa_obs <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod_pa_obs)<span class="sc">$</span>estimate[<span class="dv">2</span>]</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>percent_change_year <span class="ot">&lt;-</span> ((coef_pa <span class="sc">-</span> coef_pa_years) <span class="sc">/</span> coef_pa) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>percent_change_obs <span class="ot">&lt;-</span> ((coef_pa <span class="sc">-</span> coef_pa_obs) <span class="sc">/</span> coef_pa) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>percent_change_year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7365905</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>percent_change_obs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.263561</code></pre>
</div>
</div>
<p><em>Interpretation</em> : The change in the coefficient for physical activity when adjusting for years_working and obesity is relatively small (less than 20%). This suggests that while years_working and obesity are independent predictors of QoL, they do not act as confounders for the relationship between physical activity and QoL.</p>
</section>
<section id="multivariable-analysis" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="multivariable-analysis"><span class="header-section-number">3.3</span> Multivariable analysis</h2>
<p>We fit two models:</p>
<section id="model-1-full-model-main-effects-only." class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="model-1-full-model-main-effects-only."><span class="header-section-number">3.3.1</span> model 1: full model (main effects only).</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mod_full<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> obesity <span class="sc">+</span> phys_activity <span class="sc">+</span> years_working, <span class="at">data=</span> df)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_full, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 6: Full Model (main effects only)"</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="cunbdzazuj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cunbdzazuj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cunbdzazuj thead, #cunbdzazuj tbody, #cunbdzazuj tfoot, #cunbdzazuj tr, #cunbdzazuj td, #cunbdzazuj th {
  border-style: none;
}

#cunbdzazuj p {
  margin: 0;
  padding: 0;
}

#cunbdzazuj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cunbdzazuj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cunbdzazuj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cunbdzazuj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cunbdzazuj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cunbdzazuj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cunbdzazuj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cunbdzazuj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cunbdzazuj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cunbdzazuj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cunbdzazuj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cunbdzazuj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cunbdzazuj .gt_spanner_row {
  border-bottom-style: hidden;
}

#cunbdzazuj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cunbdzazuj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cunbdzazuj .gt_from_md > :first-child {
  margin-top: 0;
}

#cunbdzazuj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cunbdzazuj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cunbdzazuj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cunbdzazuj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cunbdzazuj .gt_row_group_first td {
  border-top-width: 2px;
}

#cunbdzazuj .gt_row_group_first th {
  border-top-width: 2px;
}

#cunbdzazuj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cunbdzazuj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cunbdzazuj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cunbdzazuj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cunbdzazuj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cunbdzazuj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cunbdzazuj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cunbdzazuj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cunbdzazuj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cunbdzazuj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cunbdzazuj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cunbdzazuj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cunbdzazuj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cunbdzazuj .gt_left {
  text-align: left;
}

#cunbdzazuj .gt_center {
  text-align: center;
}

#cunbdzazuj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cunbdzazuj .gt_font_normal {
  font-weight: normal;
}

#cunbdzazuj .gt_font_bold {
  font-weight: bold;
}

#cunbdzazuj .gt_font_italic {
  font-style: italic;
}

#cunbdzazuj .gt_super {
  font-size: 65%;
}

#cunbdzazuj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cunbdzazuj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cunbdzazuj .gt_indent_1 {
  text-indent: 5px;
}

#cunbdzazuj .gt_indent_2 {
  text-indent: 10px;
}

#cunbdzazuj .gt_indent_3 {
  text-indent: 15px;
}

#cunbdzazuj .gt_indent_4 {
  text-indent: 20px;
}

#cunbdzazuj .gt_indent_5 {
  text-indent: 25px;
}

#cunbdzazuj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cunbdzazuj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 6: Full Model (main effects only)</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">53</td>
<td class="gt_row gt_center" headers="conf.low">51, 55</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Obesity Status</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" headers="estimate">-17</td>
<td class="gt_row gt_center" headers="conf.low">-19, -15</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Physical Activity Score</td>
<td class="gt_row gt_center" headers="estimate">3.1</td>
<td class="gt_row gt_center" headers="conf.low">2.9, 3.4</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Years of Working</td>
<td class="gt_row gt_center" headers="estimate">-0.26</td>
<td class="gt_row gt_center" headers="conf.low">-0.33, -0.19</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="model-2-full-model-interaction-between-physical-activity-and-obesity." class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="model-2-full-model-interaction-between-physical-activity-and-obesity."><span class="header-section-number">3.3.2</span> model 2: full model + interaction between physical activity and obesity.</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mod_pa.obs<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity <span class="sc">+</span> years_working <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity<span class="sc">:</span>obesity, <span class="at">data=</span> df)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_pa.obs, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 7: Full Model + Interaction Term"</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ashqnxgcax" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ashqnxgcax table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ashqnxgcax thead, #ashqnxgcax tbody, #ashqnxgcax tfoot, #ashqnxgcax tr, #ashqnxgcax td, #ashqnxgcax th {
  border-style: none;
}

#ashqnxgcax p {
  margin: 0;
  padding: 0;
}

#ashqnxgcax .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ashqnxgcax .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ashqnxgcax .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ashqnxgcax .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ashqnxgcax .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ashqnxgcax .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ashqnxgcax .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ashqnxgcax .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ashqnxgcax .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ashqnxgcax .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ashqnxgcax .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ashqnxgcax .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ashqnxgcax .gt_spanner_row {
  border-bottom-style: hidden;
}

#ashqnxgcax .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ashqnxgcax .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ashqnxgcax .gt_from_md > :first-child {
  margin-top: 0;
}

#ashqnxgcax .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ashqnxgcax .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ashqnxgcax .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ashqnxgcax .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ashqnxgcax .gt_row_group_first td {
  border-top-width: 2px;
}

#ashqnxgcax .gt_row_group_first th {
  border-top-width: 2px;
}

#ashqnxgcax .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ashqnxgcax .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ashqnxgcax .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ashqnxgcax .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ashqnxgcax .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ashqnxgcax .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ashqnxgcax .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ashqnxgcax .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ashqnxgcax .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ashqnxgcax .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ashqnxgcax .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ashqnxgcax .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ashqnxgcax .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ashqnxgcax .gt_left {
  text-align: left;
}

#ashqnxgcax .gt_center {
  text-align: center;
}

#ashqnxgcax .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ashqnxgcax .gt_font_normal {
  font-weight: normal;
}

#ashqnxgcax .gt_font_bold {
  font-weight: bold;
}

#ashqnxgcax .gt_font_italic {
  font-style: italic;
}

#ashqnxgcax .gt_super {
  font-size: 65%;
}

#ashqnxgcax .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ashqnxgcax .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ashqnxgcax .gt_indent_1 {
  text-indent: 5px;
}

#ashqnxgcax .gt_indent_2 {
  text-indent: 10px;
}

#ashqnxgcax .gt_indent_3 {
  text-indent: 15px;
}

#ashqnxgcax .gt_indent_4 {
  text-indent: 20px;
}

#ashqnxgcax .gt_indent_5 {
  text-indent: 25px;
}

#ashqnxgcax .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ashqnxgcax div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 7: Full Model + Interaction Term</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">51</td>
<td class="gt_row gt_center" headers="conf.low">48, 53</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Physical Activity Score</td>
<td class="gt_row gt_center" headers="estimate">3.6</td>
<td class="gt_row gt_center" headers="conf.low">3.3, 3.9</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Years of Working</td>
<td class="gt_row gt_center" headers="estimate">-0.24</td>
<td class="gt_row gt_center" headers="conf.low">-0.31, -0.18</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Obesity Status</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" headers="estimate">-9.3</td>
<td class="gt_row gt_center" headers="conf.low">-12, -6.2</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Physical Activity Score * Obesity Status</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Physical Activity Score * obese</td>
<td class="gt_row gt_center" headers="estimate">-1.6</td>
<td class="gt_row gt_center" headers="conf.low">-2.2, -1.1</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
</section>
<section id="model-comparison" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="model-comparison"><span class="header-section-number">3.4</span> Model comparison</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood Ratio Test</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_full, mod_pa.obs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: qol ~ obesity + phys_activity + years_working
Model 2: qol ~ phys_activity + years_working + obesity + phys_activity:obesity
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    196 5932.4                                  
2    195 5063.1  1    869.25 33.478 2.834e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<p>Model Comparison: Why Model 2 is Better</p>
<p>The Analysis of Variance (ANOVA) table provides strong statistical evidence that Model 2 (Table 7; with interaction) is superior to Model 1 (Table 6; main effects only).</p>
<p>Lower Residual Sum of Squares (RSS): Model 2 has a lower RSS (5063.1) compared to Model 1 (5932.4). A lower RSS indicates that Model 2 has smaller prediction errors and fits the observed data more closely than Model 1.</p>
<p>Statistically Significant Improvement: The ANOVA comparison shows a highly significant p-value (2.834e-08, denoted as ***), which confirms that the reduction in error (RSS) achieved by adding the interaction term is statistically significant.</p>
<p>Improved Explanatory Power (<span class="math inline">\(R^2\)</span>): The performance table confirms that Model 2 explains a higher proportion of the variance in the data (<span class="math inline">\(R^2\)</span> = 0.864) compared to Model 1 (<span class="math inline">\(R^2\)</span> = 0.841).</p>
</section>
</section>
<section id="part-d-model-checking" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Part D: Model Checking</h1>
<p>We perform diagnostics on Model 2 to check assumptions and identify influential outliers</p>
<section id="check-assumptions" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="check-assumptions"><span class="header-section-number">4.1</span> Check assumptions</h2>
<section id="linearity" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="linearity"><span class="header-section-number">4.1.1</span> Linearity</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/linearity-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : The Residuals vs Fitted plot confirms the linearity assumption is satisfied, as the red smoothing line is horizontal and centers closely on zero across the entire range of fitted values. This indicates no non-linear patterns, such as U-shapes or curves, suggesting the linear model appropriately captures the relationship between the predictors and the outcome.</p>
</section>
<section id="normality-of-residuals" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="normality-of-residuals"><span class="header-section-number">4.1.2</span> Normality of residuals</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/normality%20of%20residuals-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : While central points align with the diagonal, there are some slight deviations in the tails and head (e.g 71,156, 116).</p>
</section>
<section id="homocedasticity-scale-location" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="homocedasticity-scale-location"><span class="header-section-number">4.1.3</span> Homocedasticity (Scale-Location)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/homocedasticity%20(scale-location)-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : A slight trend is visible, but no severe convergence or divergence is observed. This suggests that variance is relatively constant.</p>
</section>
<section id="independence-of-residues" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="independence-of-residues"><span class="header-section-number">4.1.4</span> Independence of residues</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(mod_pa.obs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  mod_pa.obs
DW = 2.1545, p-value = 0.8649
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p><em>Interpretation</em> : The Durbin-Watson test (<span class="math inline">\(p &gt; 0.05\)</span>) suggests no significant autocorrelation.</p>
</section>
</section>
<section id="influential-analysis" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="influential-analysis"><span class="header-section-number">4.2</span> Influential Analysis</h2>
<p>We identify influential points using Cook’s Distance, DFBETAS, and Leverage.</p>
<section id="cooks-distance" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="cooks-distance"><span class="header-section-number">4.2.1</span> Cook’s Distance</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which =</span> <span class="dv">4</span>, <span class="at">cook.levels =</span> cutoff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/Cook's%20Distance-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em>: This plot measures the overall influence of each observation on the model’s fitted values.</p>
<p>Observation 127 has the highest spike (Cook’s distance <span class="math inline">\(\approx 0.10\)</span>), followed by observations 156 and 72. Since all values are well below the conventional threshold of 1 (and generally low even for stricter thresholds like <span class="math inline">\(4/n\)</span>), these points are influential but not problematic enough to invalidate the model.</p>
</section>
<section id="leverage-points" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="leverage-points"><span class="header-section-number">4.2.2</span> Leverage Points</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/Leverage%20Points-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em>: This plot helps identify influential data points by comparing standardized residuals against leverage (how extreme the predictor values are).</p>
<p>Most data points cluster to the left, indicating low leverage. Observation 127 stands out in the upper right corner, meaning it has both high leverage and a relatively large residual. However, it does not cross the critical Cook’s distance contours (the dashed lines usually set at 0.5 or 1), suggesting it is not severely distorting the model despite being an outlier.</p>
</section>
<section id="dfbetas" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="dfbetas"><span class="header-section-number">4.2.3</span> DFBETAS</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfbetaPlots</span>(mod_pa.obs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/DFBETAS-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : This plot shows how much each regression coefficient would change if a single observation were removed.</p>
<p>The scatterplots for all four terms (phys_activity, years_working, obesity, and the interaction) show random patterns centered around zero. There are no extreme spikes exceeding standard thresholds, confirming that the estimated coefficients are stable and not driven by any single data point.</p>
</section>
</section>
<section id="remedial-measures" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="remedial-measures"><span class="header-section-number">4.3</span> Remedial Measures</h2>
<p>We remove the identified influential observations and refit the model</p>
<section id="remove-influential-observations-and-refit-the-model" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="remove-influential-observations-and-refit-the-model"><span class="header-section-number">4.3.1</span> Remove influential observations and refit the model</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cutoff for influential points (Cook's Distance)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A common threshold is 4/n, where n is the number of observations</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(df)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_pa.obs, df) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">ifelse</span>(.cooksd <span class="sc">&gt;</span> cutoff, <span class="st">"Influential (Remove)"</span>, <span class="st">"Normal (Keep)"</span>))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> .cooksd, <span class="at">fill =</span> Status)) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span>      </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> cutoff, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Influential (Remove)"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>, <span class="st">"Normal (Keep)"</span> <span class="ot">=</span> <span class="st">"gray70"</span>)) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook's Distance: Selection of Points for Removal"</span>,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Red dashed line indicates cutoff threshold:"</span>, <span class="fu">round</span>(cutoff, <span class="dv">4</span>)),</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Observation ID"</span>,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cook's Distance"</span>) <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/illustrate-cooks-distance-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Identifying Influential Observations for Removal</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(df)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Augment the model to get Cook's Distance (.cooksd) for every point</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>df_augmented <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_pa.obs, df)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out points that exceed the cutoff</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We keep rows where .cooksd is LESS than the cutoff</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>df_no_outliers <span class="ot">&lt;-</span> df_augmented <span class="sc">%&gt;%</span> </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&lt;</span> cutoff)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Refit the model using this cleaned dataset</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>mod_pa.obs_refit <span class="ot">&lt;-</span> <span class="fu">lm</span>(qol <span class="sc">~</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> years_working <span class="sc">+</span> phys_activity<span class="sc">:</span>obesity, <span class="at">data =</span> df_no_outliers)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize and compare</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_pa.obs_refit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term                       estimate std.error statistic   p.value
  &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)                  51.3      1.03       49.9  9.40e-108
2 phys_activity                 3.60     0.128      28.2  4.66e- 68
3 obesityobese                 -9.52     1.52       -6.24 2.95e-  9
4 years_working                -0.274    0.0308     -8.90 5.83e- 16
5 phys_activity:obesityobese   -1.63     0.275      -5.91 1.68e-  8</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(mod_pa.obs, mod_pa.obs_refit, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name             | Model |    R2 | R2 (adj.) |  RMSE | Sigma | AIC weights
--------------------------------------------------------------------------
mod_pa.obs_refit |    lm | 0.893 |     0.890 | 4.332 | 4.391 |        1.00
mod_pa.obs       |    lm | 0.864 |     0.862 | 5.031 | 5.096 |    2.87e-31

Name             | AICc weights | BIC weights | Performance-Score
-----------------------------------------------------------------
mod_pa.obs_refit |         1.00 |        1.00 |           100.00%
mod_pa.obs       |     2.92e-31 |    2.31e-31 |             0.00%</code></pre>
</div>
</div>
<p><em>Interpretation</em> : Removing the influential observations identified by Cook’s Distance didn’t drastically change the results, which confirms that our original model was solid to begin with.</p>
<p>Coefficient Stability: The estimates for the predictors were very stable. For example, the effect of physical activity remained virtually unchanged (Original <span class="math inline">\(\beta = 3.6\)</span> vs.&nbsp;Refitted <span class="math inline">\(\beta = 3.60\)</span>).</p>
<p>Crucially, the interaction term also stayed almost exactly the same, shifting only slightly from -1.6 to -1.63.</p>
<p>Model Fit (<span class="math inline">\(R^2\)</span>): We did see an improvement in how well the model fits the data. The Adjusted <span class="math inline">\(R^2\)</span> rose from 0.862 to 0.890, and the prediction error (RMSE) dropped from 5.031 to 4.332. This suggests that the influential points were adding some “noise” to the model, but taking them out didn’t change the underlying trends.</p>
<p>Conclusion:This sensitivity analysis gives us confidence in the results. It proves that the relationships we found, specifically the interaction between obesity and physical activity,are real and reliable, rather than being driven by a handful of extreme cases.</p>
</section>
</section>
</section>
<section id="part-e-results-presentation-and-interpretation" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Part E: Results Presentation and Interpretation</h1>
<section id="final-regression-table" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="final-regression-table"><span class="header-section-number">5.1</span> Final regression table</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>final_tbl <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  mod_pa.obs,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(<span class="at">years_working =</span> <span class="st">"Years of working"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">phys_activity =</span> <span class="st">"Physical activity"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">obesity =</span> <span class="st">"Obesity"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">qol =</span> <span class="st">"Quality of life"</span>),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">pvalue_fun =</span> <span class="sc">~</span><span class="fu">style_pvalue</span>(.x, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">eps =</span> <span class="fl">0.001</span>),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate_fun =</span> <span class="sc">~</span><span class="fu">style_number</span>(.x, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_glance_table</span>(</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">include =</span> <span class="fu">c</span>(r.squared, adj.r.squared, statistic),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">list</span>(<span class="at">statistic =</span> <span class="st">"F-statistic"</span>)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"**Variables**"</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="st">"**Adj. Beta**"</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="st">"**SE**"</span>,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="st">"**t-stat**"</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_column_unhide</span>(<span class="fu">c</span>(std.error, statistic)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_table_body</span>(</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> .x <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(std.error, <span class="at">.after =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">relocate</span>(statistic, <span class="at">.before =</span> p.value)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Multivariable Linear Regression Model for Quality of Life Score (QOL)**"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_align_table_header</span>(<span class="at">align =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.style =</span> <span class="st">"none"</span>,</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.style =</span> <span class="st">"none"</span>,</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.border.bottom.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.border.bottom.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.hlines.style =</span> <span class="st">"none"</span>,</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="dv">2</span>),</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.width =</span> <span class="fu">px</span>(<span class="dv">2</span>),</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">5</span>)</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"right"</span>),</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> <span class="sc">-</span>label)</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_align_table_header</span>(<span class="at">align =</span> <span class="st">"left"</span>)</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>final_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="lksfxzlmfj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lksfxzlmfj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lksfxzlmfj thead, #lksfxzlmfj tbody, #lksfxzlmfj tfoot, #lksfxzlmfj tr, #lksfxzlmfj td, #lksfxzlmfj th {
  border-style: none;
}

#lksfxzlmfj p {
  margin: 0;
  padding: 0;
}

#lksfxzlmfj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lksfxzlmfj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lksfxzlmfj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lksfxzlmfj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lksfxzlmfj .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lksfxzlmfj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#lksfxzlmfj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lksfxzlmfj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lksfxzlmfj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lksfxzlmfj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lksfxzlmfj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lksfxzlmfj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lksfxzlmfj .gt_spanner_row {
  border-bottom-style: hidden;
}

#lksfxzlmfj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lksfxzlmfj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lksfxzlmfj .gt_from_md > :first-child {
  margin-top: 0;
}

#lksfxzlmfj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lksfxzlmfj .gt_row {
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lksfxzlmfj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lksfxzlmfj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lksfxzlmfj .gt_row_group_first td {
  border-top-width: 2px;
}

#lksfxzlmfj .gt_row_group_first th {
  border-top-width: 2px;
}

#lksfxzlmfj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lksfxzlmfj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lksfxzlmfj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lksfxzlmfj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lksfxzlmfj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lksfxzlmfj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lksfxzlmfj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lksfxzlmfj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lksfxzlmfj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#lksfxzlmfj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lksfxzlmfj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lksfxzlmfj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lksfxzlmfj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lksfxzlmfj .gt_left {
  text-align: left;
}

#lksfxzlmfj .gt_center {
  text-align: center;
}

#lksfxzlmfj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lksfxzlmfj .gt_font_normal {
  font-weight: normal;
}

#lksfxzlmfj .gt_font_bold {
  font-weight: bold;
}

#lksfxzlmfj .gt_font_italic {
  font-style: italic;
}

#lksfxzlmfj .gt_super {
  font-size: 65%;
}

#lksfxzlmfj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lksfxzlmfj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lksfxzlmfj .gt_indent_1 {
  text-indent: 5px;
}

#lksfxzlmfj .gt_indent_2 {
  text-indent: 10px;
}

#lksfxzlmfj .gt_indent_3 {
  text-indent: 15px;
}

#lksfxzlmfj .gt_indent_4 {
  text-indent: 20px;
}

#lksfxzlmfj .gt_indent_5 {
  text-indent: 25px;
}

#lksfxzlmfj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lksfxzlmfj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Multivariable Linear Regression Model for Quality of Life Score (QOL)</strong></caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Variables</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: right;" data-quarto-table-cell-role="th" scope="col"><strong>Adj. Beta</strong></th>
<th id="std.error" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: right;" data-quarto-table-cell-role="th" scope="col"><strong>SE</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: right;" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: right;" data-quarto-table-cell-role="th" scope="col"><strong>t-stat</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: right;" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">(Intercept)</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate">50.59</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error">1.16</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low">48.31, 52.87</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic">43.7</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: right; font-weight: bold;">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Physical activity</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate">3.58</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error">0.145</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low">3.30, 3.87</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic">24.8</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: right; font-weight: bold;">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Years of working</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate">-0.24</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error">0.034</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low">-0.31, -0.18</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic">-7.23</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: right; font-weight: bold;">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Obesity</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate">—</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error">—</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low">—</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic">—</td>
<td class="gt_row gt_center" style="text-align: right;" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate">-9.25</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error">1.56</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low">-12.32, -6.18</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic">-5.95</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: right; font-weight: bold;">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Physical activity * Obesity</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Physical activity * obese</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate">-1.62</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error">0.280</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low">-2.17, -1.07</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic">-5.79</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: right; font-weight: bold;">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">R²</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: right; border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;">0.864</td>
<td class="gt_row gt_center" headers="std.error" style="text-align: right; border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;"><br>
</td>
<td class="gt_row gt_center" headers="conf.low" style="text-align: right; border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;"><br>
</td>
<td class="gt_row gt_center" headers="statistic" style="text-align: right; border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;"><br>
</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: right; border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3;"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Adjusted R²</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate">0.862</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">F-statistic</td>
<td class="gt_row gt_center" style="text-align: right;" headers="estimate">311</td>
<td class="gt_row gt_center" style="text-align: right;" headers="std.error"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="statistic"><br>
</td>
<td class="gt_row gt_center" style="text-align: right;" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="6" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, SE = Standard Error</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="final-model-equation" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="final-model-equation"><span class="header-section-number">5.2</span> Final model equation</h2>
<p>The final linear regression model on quality of life is given by the equation:</p>
<p><span class="math display">\[
\text{QOL} = 50.59
+ 3.58 \space (\text{Physical Activity})
- 0.24 \space (\text{Years Working})
- 9.25 \space (\text{Obese})
- 1.62 \space (\text{Physical Activity} \times \text{Obese})
+ \varepsilon
\]</span></p>
<p>Where:</p>
<ul>
<li>QOL: Quality of Life score (outcome variable)</li>
<li>Physical Activity: Physical activity score (predictor)</li>
<li>Years Working: Number of years working (predictor)</li>
<li>Obese: Indicator variable for obesity status (1 = obese, 0 = not obese)</li>
<li><span class="math inline">\(\varepsilon\)</span>: Error term capturing unexplained variability</li>
</ul>
</section>
<section id="interaction-plot" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="interaction-plot"><span class="header-section-number">5.3</span> Interaction Plot</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(mod_pa.obs, <span class="at">pred =</span> phys_activity, <span class="at">modx =</span> obesity</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>              , <span class="at">plot.points =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/Interaction%20plot%20of%20the%20final%20model-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : The interaction plot demonstrates significant effect modification, characterized by heterogeneity of regression slopes where the positive association between physical activity and QOL is attenuated in the obese group (<span class="math inline">\(\beta \approx 2.0\)</span>) relative to the non-obese group (<span class="math inline">\(\beta \approx 3.6\)</span>). This differential marginal effect confirms that while physical activity yields positive outcomes for all, the rate of improvement is statistically constrained by obesity status, resulting in a widening disparity at higher activity levels.</p>
</section>
<section id="interpretation-of-final-model-results" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="interpretation-of-final-model-results"><span class="header-section-number">5.4</span> Interpretation of Final Model Results</h2>
<section id="main-effects-and-interaction-terms" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="main-effects-and-interaction-terms"><span class="header-section-number">5.4.1</span> Main Effects and Interaction Terms</h3>
<p>The final model identifies several statistically significant predictors on quality of life:</p>
<ul>
<li><p><strong>Years Working</strong>: There is a significant negative association between employment duration and quality of life (<span class="math inline">\(\beta = -0.24, p &lt; 0.001\)</span>). For every additional year of working, the Quality of Life score decreases by 0.24 units.</p></li>
<li><p><strong>Physical Activity</strong>: Physical activity is a strong positive predictor. For non-obese individuals (the reference group), each 1-unit increase in physical activity score is associated with a 3.6 unit increase in Quality of Life (<span class="math inline">\(\beta = 3.6, p &lt; 0.001\)</span>).</p></li>
<li><p><strong>Obesity</strong>: Obesity is associated with a significantly lower baseline Quality of Life. When physical activity is zero, obese individuals have a Quality of Life score that is 9.3 points lower than non-obese individuals (<span class="math inline">\(\beta = -9.3, p &lt; 0.001\)</span>).</p></li>
<li><p><strong>Interaction (Physical Activity × Obesity)</strong>: The significant negative interaction term (<span class="math inline">\(\beta = -1.6, p &lt; 0.001\)</span>) indicates that obesity dampens the beneficial effect of exercise. While physical activity improves Quality of Life for everyone, the rate of improvement is slower for obese individuals, who gain only 2.0 points (<span class="math inline">\(3.6 - 1.6\)</span>) per unit of activity compared to 3.6 points for non-obese individuals.</p></li>
</ul>
</section>
<section id="model-comparison-1" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="model-comparison-1"><span class="header-section-number">5.4.2</span> Model Comparison</h3>
<p>Compared to the main effects model (Model 1), the final model including the interaction term (Model 2) demonstrates superior fit and explanatory power:</p>
<ul>
<li><p><strong>Statistical Significance</strong>:The Analysis of Variance (ANOVA) comparison reveals that adding the interaction term significantly reduced the Residual Sum of Squares (RSS) from 5932.4 to 5063.1 (<span class="math inline">\(F = 33.48, p &lt; 0.001\)</span>). This confirms that the interaction between physical activity and obesity provides a statistically significant improvement in predicting Quality of Life.</p></li>
<li><p><strong>Explanatory Power</strong>:The inclusion of the interaction term increased the <span class="math inline">\(R^2\)</span> from 0.841 to 0.864, indicating that the final model explains a larger proportion (approximately 86.4%) of the variance in the outcome compared to the main effects model.</p></li>
</ul>
</section>
<section id="practical-significance" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="practical-significance"><span class="header-section-number">5.4.3</span> Practical Significance</h3>
<p>The findings have clear implications:</p>
<ul>
<li><p><strong>Workplace Wellness</strong>: The significant negative association between Years Working (<span class="math inline">\(\beta = -0.24\)</span>) and Quality of Life implies that long-term employment is associated with a cumulative decline in well-being. This highlights the practical need for workplace wellness initiatives and stress management programs for employees with longer tenure.</p></li>
<li><p><strong>Integrated Health Interventions</strong>: The Interaction term (<span class="math inline">\(\beta = -1.6\)</span>) reveals that obesity not only lowers baseline Quality of Life but also dampens the positive effects of physical activity. Practically, this means “one size fits all” exercise recommendations may be less effective for obese individuals. Interventions should prioritize weight management alongside physical activity to unlock the steeper “Quality of Life return” observed in non-obese individuals.</p></li>
</ul>
</section>
<section id="model-assumptions-and-diagnostics" class="level3" data-number="5.4.4">
<h3 data-number="5.4.4" class="anchored" data-anchor-id="model-assumptions-and-diagnostics"><span class="header-section-number">5.4.4</span> Model Assumptions and Diagnostics</h3>
<p>Model checking revealed:</p>
<ul>
<li><p><strong>Linearity</strong>: The Residuals vs Fitted plot shows a red smoothing line that is approximately horizontal and centered on zero, indicating that the linear relationship between the predictors and Quality of Life is correctly specified and the linearity assumption is satisfied.</p></li>
<li><p><strong>Normality</strong>: The Q-Q plot demonstrates that the standardized residuals align closely with the theoretical diagonal line across the entire range of quantiles. Although there are slight deviations at the extreme tails (specifically observations 156, 116, and 71), the overall pattern is straight and lacks significant skewness or heavy tails. This indicates that the residuals are approximately normally distributed, satisfying the normality assumption.</p></li>
<li><p><strong>Homoscedasticity</strong>: The Scale-Location plot reveals that the vertical spread of the standardized residuals remains relatively consistent across the range of fitted values. There is no evidence of divergence (expanding variance) or convergence (contracting variance) in the residuals as the predicted values increase. This stability in the error terms confirms that the assumption of homoscedasticity is satisfied.</p></li>
</ul>
</section>
<section id="influential-observations-and-their-impact-on-model-prediction" class="level3" data-number="5.4.5">
<h3 data-number="5.4.5" class="anchored" data-anchor-id="influential-observations-and-their-impact-on-model-prediction"><span class="header-section-number">5.4.5</span> Influential Observations and their impact on model prediction:</h3>
<p>The influential observations (127, 156, 72) introduce some noise but do not compromise the validity of the model’s predictions. The model remains robust, and the relationships identified (such as the interaction between obesity and physical activity) hold true regardless of whether these points are included.</p>
</section>
</section>
</section>
<section id="prediction" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Prediction</h1>
<section id="new-data-simulation" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="new-data-simulation"><span class="header-section-number">6.1</span> New data simulation</h2>
<p>To visualize the model’s predictions across a representative range of scenarios, we generated a new dataset (new_data) using a factorial grid that combines key values for years_working (0, 20, 40 years), phys_activity (0 to 10 in steps of 2), and both obesity levels.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">20</span>),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>new_data <span class="sc">%&gt;%</span> <span class="fu">data.table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    years_working phys_activity   obesity
            &lt;num&gt;         &lt;num&gt;    &lt;fctr&gt;
 1:             0             0 not obese
 2:            20             0 not obese
 3:            40             0 not obese
 4:             0             2 not obese
 5:            20             2 not obese
 6:            40             2 not obese
 7:             0             4 not obese
 8:            20             4 not obese
 9:            40             4 not obese
10:             0             6 not obese
11:            20             6 not obese
12:            40             6 not obese
13:             0             8 not obese
14:            20             8 not obese
15:            40             8 not obese
16:             0            10 not obese
17:            20            10 not obese
18:            40            10 not obese
19:             0             0     obese
20:            20             0     obese
21:            40             0     obese
22:             0             2     obese
23:            20             2     obese
24:            40             2     obese
25:             0             4     obese
26:            20             4     obese
27:            40             4     obese
28:             0             6     obese
29:            20             6     obese
30:            40             6     obese
31:             0             8     obese
32:            20             8     obese
33:            40             8     obese
34:             0            10     obese
35:            20            10     obese
36:            40            10     obese
    years_working phys_activity   obesity</code></pre>
</div>
</div>
</section>
<section id="fitted-values" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="fitted-values"><span class="header-section-number">6.2</span> Fitted values</h2>
<p>We then applied the final regression model to the new dataset to compute the predicted Quality of Life scores and their corresponding 95% confidence intervals for each hypothetical scenario.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>predict<span class="ot">&lt;-</span> <span class="fu">augment</span> (mod_pa.obs, <span class="at">newdata =</span> new_data, <span class="at">interval=</span><span class="st">"confidence"</span>,<span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>predict <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted QOL on New Dataset"</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="xhhbnrkbsp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xhhbnrkbsp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xhhbnrkbsp thead, #xhhbnrkbsp tbody, #xhhbnrkbsp tfoot, #xhhbnrkbsp tr, #xhhbnrkbsp td, #xhhbnrkbsp th {
  border-style: none;
}

#xhhbnrkbsp p {
  margin: 0;
  padding: 0;
}

#xhhbnrkbsp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xhhbnrkbsp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xhhbnrkbsp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xhhbnrkbsp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xhhbnrkbsp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xhhbnrkbsp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xhhbnrkbsp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xhhbnrkbsp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xhhbnrkbsp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xhhbnrkbsp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xhhbnrkbsp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xhhbnrkbsp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xhhbnrkbsp .gt_spanner_row {
  border-bottom-style: hidden;
}

#xhhbnrkbsp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xhhbnrkbsp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xhhbnrkbsp .gt_from_md > :first-child {
  margin-top: 0;
}

#xhhbnrkbsp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xhhbnrkbsp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xhhbnrkbsp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xhhbnrkbsp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xhhbnrkbsp .gt_row_group_first td {
  border-top-width: 2px;
}

#xhhbnrkbsp .gt_row_group_first th {
  border-top-width: 2px;
}

#xhhbnrkbsp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhhbnrkbsp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xhhbnrkbsp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xhhbnrkbsp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xhhbnrkbsp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhhbnrkbsp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xhhbnrkbsp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xhhbnrkbsp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xhhbnrkbsp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xhhbnrkbsp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xhhbnrkbsp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhhbnrkbsp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xhhbnrkbsp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhhbnrkbsp .gt_left {
  text-align: left;
}

#xhhbnrkbsp .gt_center {
  text-align: center;
}

#xhhbnrkbsp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xhhbnrkbsp .gt_font_normal {
  font-weight: normal;
}

#xhhbnrkbsp .gt_font_bold {
  font-weight: bold;
}

#xhhbnrkbsp .gt_font_italic {
  font-style: italic;
}

#xhhbnrkbsp .gt_super {
  font-size: 65%;
}

#xhhbnrkbsp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xhhbnrkbsp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xhhbnrkbsp .gt_indent_1 {
  text-indent: 5px;
}

#xhhbnrkbsp .gt_indent_2 {
  text-indent: 10px;
}

#xhhbnrkbsp .gt_indent_3 {
  text-indent: 15px;
}

#xhhbnrkbsp .gt_indent_4 {
  text-indent: 20px;
}

#xhhbnrkbsp .gt_indent_5 {
  text-indent: 25px;
}

#xhhbnrkbsp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xhhbnrkbsp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border">Predicted QOL on New Dataset</th>
</tr>
<tr class="gt_col_headings even">
<th id="years_working" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">years_working</th>
<th id="phys_activity" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">phys_activity</th>
<th id="obesity" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">obesity</th>
<th id="a.fitted" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">.fitted</th>
<th id="a.lower" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">.lower</th>
<th id="a.upper" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">.upper</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">50.59157</td>
<td class="gt_row gt_right" headers=".lower">48.31021</td>
<td class="gt_row gt_right" headers=".upper">52.87292</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">45.72375</td>
<td class="gt_row gt_right" headers=".lower">44.05045</td>
<td class="gt_row gt_right" headers=".upper">47.39704</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">40.85593</td>
<td class="gt_row gt_right" headers=".lower">38.87469</td>
<td class="gt_row gt_right" headers=".upper">42.83717</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">2</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">57.75548</td>
<td class="gt_row gt_right" headers=".lower">55.81983</td>
<td class="gt_row gt_right" headers=".upper">59.69112</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">2</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">52.88766</td>
<td class="gt_row gt_right" headers=".lower">51.66817</td>
<td class="gt_row gt_right" headers=".upper">54.10715</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">2</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">48.01984</td>
<td class="gt_row gt_right" headers=".lower">46.35922</td>
<td class="gt_row gt_right" headers=".upper">49.68047</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">4</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">64.91939</td>
<td class="gt_row gt_right" headers=".lower">63.20498</td>
<td class="gt_row gt_right" headers=".upper">66.63379</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">4</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">60.05157</td>
<td class="gt_row gt_right" headers=".lower">59.14342</td>
<td class="gt_row gt_right" headers=".upper">60.95973</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">4</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">55.18376</td>
<td class="gt_row gt_right" headers=".lower">53.68697</td>
<td class="gt_row gt_right" headers=".upper">56.68054</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">6</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">72.08330</td>
<td class="gt_row gt_right" headers=".lower">70.41537</td>
<td class="gt_row gt_right" headers=".upper">73.75123</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">6</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">67.21548</td>
<td class="gt_row gt_right" headers=".lower">66.31400</td>
<td class="gt_row gt_right" headers=".upper">68.11697</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">6</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">62.34767</td>
<td class="gt_row gt_right" headers=".lower">60.80708</td>
<td class="gt_row gt_right" headers=".upper">63.88826</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">8</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">79.24721</td>
<td class="gt_row gt_right" headers=".lower">77.43747</td>
<td class="gt_row gt_right" headers=".upper">81.05695</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">8</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">74.37939</td>
<td class="gt_row gt_right" headers=".lower">73.17485</td>
<td class="gt_row gt_right" headers=".upper">75.58394</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">8</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">69.51158</td>
<td class="gt_row gt_right" headers=".lower">67.73484</td>
<td class="gt_row gt_right" headers=".upper">71.28831</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">10</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">86.41112</td>
<td class="gt_row gt_right" headers=".lower">84.30907</td>
<td class="gt_row gt_right" headers=".upper">88.51317</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">10</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">81.54331</td>
<td class="gt_row gt_right" headers=".lower">79.88815</td>
<td class="gt_row gt_right" headers=".upper">83.19846</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">10</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers=".fitted">76.67549</td>
<td class="gt_row gt_right" headers=".lower">74.53294</td>
<td class="gt_row gt_right" headers=".upper">78.81804</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">41.33831</td>
<td class="gt_row gt_right" headers=".lower">38.58658</td>
<td class="gt_row gt_right" headers=".upper">44.09004</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">36.47049</td>
<td class="gt_row gt_right" headers=".lower">33.92142</td>
<td class="gt_row gt_right" headers=".upper">39.01956</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">31.60268</td>
<td class="gt_row gt_right" headers=".lower">28.61042</td>
<td class="gt_row gt_right" headers=".upper">34.59493</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">2</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">45.26444</td>
<td class="gt_row gt_right" headers=".lower">43.16314</td>
<td class="gt_row gt_right" headers=".upper">47.36574</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">2</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">40.39662</td>
<td class="gt_row gt_right" headers=".lower">38.59351</td>
<td class="gt_row gt_right" headers=".upper">42.19973</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">2</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">35.52881</td>
<td class="gt_row gt_right" headers=".lower">33.15878</td>
<td class="gt_row gt_right" headers=".upper">37.89883</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">4</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">49.19057</td>
<td class="gt_row gt_right" headers=".lower">47.44784</td>
<td class="gt_row gt_right" headers=".upper">50.93330</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">4</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">44.32275</td>
<td class="gt_row gt_right" headers=".lower">42.98753</td>
<td class="gt_row gt_right" headers=".upper">45.65798</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">4</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">39.45494</td>
<td class="gt_row gt_right" headers=".lower">37.44033</td>
<td class="gt_row gt_right" headers=".upper">41.46954</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">6</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">53.11670</td>
<td class="gt_row gt_right" headers=".lower">51.26280</td>
<td class="gt_row gt_right" headers=".upper">54.97060</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">6</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">48.24888</td>
<td class="gt_row gt_right" headers=".lower">46.80228</td>
<td class="gt_row gt_right" headers=".upper">49.69548</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">6</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">43.38107</td>
<td class="gt_row gt_right" headers=".lower">41.31263</td>
<td class="gt_row gt_right" headers=".upper">45.44950</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">8</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">57.04283</td>
<td class="gt_row gt_right" headers=".lower">54.67323</td>
<td class="gt_row gt_right" headers=".upper">59.41242</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">8</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">52.17501</td>
<td class="gt_row gt_right" headers=".lower">50.13034</td>
<td class="gt_row gt_right" headers=".upper">54.21968</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">8</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">47.30720</td>
<td class="gt_row gt_right" headers=".lower">44.80191</td>
<td class="gt_row gt_right" headers=".upper">49.81248</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">10</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">60.96896</td>
<td class="gt_row gt_right" headers=".lower">57.87522</td>
<td class="gt_row gt_right" headers=".upper">64.06269</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">10</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">56.10114</td>
<td class="gt_row gt_right" headers=".lower">53.26444</td>
<td class="gt_row gt_right" headers=".upper">58.93785</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">10</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers=".fitted">51.23333</td>
<td class="gt_row gt_right" headers=".lower">48.06273</td>
<td class="gt_row gt_right" headers=".upper">54.40392</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="prediction-visualization" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="prediction-visualization"><span class="header-section-number">6.3</span> Prediction visualization</h2>
<p>Finally, we plotted the results to visualize how physical activity improves Quality of Life for obese versus non-obese individuals, separating the graphs by years of working to clearly compare the trends across different career lengths.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predict, <span class="fu">aes</span>(<span class="at">x =</span> phys_activity, <span class="at">y =</span> .fitted, <span class="at">color =</span> obesity, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add confidence intervals (Ribbons)</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression lines</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Facet by years_working to show the relationship across career lengths</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> years_working, <span class="at">labeller =</span> label_both) <span class="sc">+</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span> </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted Quality of Life by Physical Activity and Obesity Status"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Stratified by Years Working (Model Predictions with 95% CIs)"</span>,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted QOL Score (0-100)"</span>,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Physical Activity Score (0-10)"</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Group"</span>,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Group"</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear-CA_edited_030126_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : Positive Effect of Physical Activity: Across all three panels (0, 20, and 40 years of working), there is a clear linear increase in Quality of Life (QOL) as physical activity scores rise from 0 to 10. This confirms that physical activity is beneficial for everyone, regardless of tenure or obesity status.</p>
<p>Cumulative Negative Effect of Years Working: By comparing the panels from left to right, we observe a systematic downward shift in QOL scores.</p>
<p>0 Years Working: The baseline QOL starts relatively high (around 40-50 for obese, 50-60 for non-obese).</p>
<p>40 Years Working: The entire set of lines shifts down by approximately 10 points. This visualizes the cumulative burden of long-term employment, where individuals with high tenure have significantly lower well-being compared to new entrants, holding other factors constant.</p>
</section>
</section>
<section id="conclusion" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Conclusion</h1>
<p>Physical activity is beneficial for everyone, but the return on investment is higher for non-obese individuals. However, because obese individuals start with a lower baseline QOL, physical activity remains a crucial intervention, even if the rate of improvement is slower. The gap in QOL between the groups widens at higher activity levels. Public health interventions should prioritize physical activity for all, but distinct strategies are required for obese individuals. Since they face a “double burden” of lower baseline QOL and a slower return on investment from exercise, integrated approaches combining activity with weight management may be necessary to maximize their Quality of Life outcomes.</p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb42" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Linear Regression on Quality of Life"</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Munir (23202537), Farihah (23202679), Sanggary (23202894), Khairunnisa (23202532) "</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, Linear Regression, Medical Statistics]</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="an">tags:</span><span class="co"> [R, Linear Regression, Medical Statistics]</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cerulean</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-expand: 1</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true     </span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show code" </span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 3</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="co">  comment: NA</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part A: Research question, dataset and variable creation</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Research Question / Objective</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>To study the association between physical activity, obesity, years of working, and the quality of life among adults. </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>Specifically, we aim to:</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a><span class="ss">1.   </span>Assess the individual effects of physical activity, obesity, and years of working on quality of life.</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="ss">2.   </span>Investigate potential interaction effects between physical activity and obesity on quality of life.</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="ss">3.   </span>Control for confounding factors and evaluate model fit and assumptions.</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data simulation</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: simulate-data</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.helpers)</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Set seed for reproducibility</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Define sample size</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Generate Covariates</span></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Years working: Uniform distribution between 0 and 40</span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>years_working <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">40</span>)</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Physical activity: Uniform distribution between 0 and 10</span></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>phys_activity <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Obesity: Binary (0 = not obese, 1 = obese) with 30% prevalence</span></span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>obesity_binary <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.3</span>)</span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>obesity <span class="ot">&lt;-</span> <span class="fu">factor</span>(obesity_binary, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>))</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Define Coefficients (True Population Parameters)</span></span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="dv">50</span>          <span class="co"># Intercept (Base QoL)</span></span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.2</span>        <span class="co"># Effect of years_working (slight decline over time)</span></span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="ot">&lt;-</span> <span class="fl">3.5</span>         <span class="co"># Effect of phys_activity (positive impact)</span></span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>beta_3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span>         <span class="co"># Effect of obesity (negative impact)</span></span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>beta_4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.5</span>        <span class="co"># Interaction: Benefit of phys_activity is reduced by 1.5 if obese</span></span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Calculate Outcome (Quality of Life)</span></span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Formula: Y = b0 + b1*X1 + b2*X2 + b3*X3 + b4*(X2*X3) + error</span></span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># Random error</span></span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>qol_raw <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span></span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a>  (beta_1 <span class="sc">*</span> years_working) <span class="sc">+</span></span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a>  (beta_2 <span class="sc">*</span> phys_activity) <span class="sc">+</span></span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a>  (beta_3 <span class="sc">*</span> obesity_binary) <span class="sc">+</span></span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a>  (beta_4 <span class="sc">*</span> phys_activity <span class="sc">*</span> obesity_binary) <span class="sc">+</span> <span class="co"># The Interaction Term</span></span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a>  noise</span>
<span id="cb42-81"><a href="#cb42-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Enforce Bounds (0-100)</span></span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate values to ensure they stay within the scale</span></span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a>qol <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(<span class="dv">100</span>, qol_raw))</span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-86"><a href="#cb42-86" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Create Dataframe</span></span>
<span id="cb42-87"><a href="#cb42-87" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">qol =</span> <span class="fu">round</span>(qol, <span class="dv">1</span>),</span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">round</span>(years_working, <span class="dv">1</span>),</span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">round</span>(phys_activity, <span class="dv">1</span>),</span>
<span id="cb42-92"><a href="#cb42-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> obesity</span>
<span id="cb42-93"><a href="#cb42-93" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-94"><a href="#cb42-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-95"><a href="#cb42-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-96"><a href="#cb42-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-97"><a href="#cb42-97" aria-hidden="true" tabindex="-1"></a>Generate QoL dataset (n=200) with:</span>
<span id="cb42-98"><a href="#cb42-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-99"><a href="#cb42-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ranges: qol 0-100, years_working 0-40, phys_activity 0-10</span>
<span id="cb42-100"><a href="#cb42-100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>obesity as factor with 2 levels</span>
<span id="cb42-101"><a href="#cb42-101" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>interaction: phys_activity * obesity</span>
<span id="cb42-102"><a href="#cb42-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-103"><a href="#cb42-103" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Preparation- Glimpse the generated data</span></span>
<span id="cb42-104"><a href="#cb42-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-105"><a href="#cb42-105" aria-hidden="true" tabindex="-1"></a><span class="fu">### Load libraries</span></span>
<span id="cb42-108"><a href="#cb42-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-109"><a href="#cb42-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-libraries</span></span>
<span id="cb42-110"><a href="#cb42-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-111"><a href="#cb42-111" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb42-112"><a href="#cb42-112" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb42-113"><a href="#cb42-113" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb42-114"><a href="#cb42-114" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb42-115"><a href="#cb42-115" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb42-116"><a href="#cb42-116" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb42-117"><a href="#cb42-117" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb42-118"><a href="#cb42-118" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb42-119"><a href="#cb42-119" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb42-120"><a href="#cb42-120" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb42-121"><a href="#cb42-121" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb42-122"><a href="#cb42-122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb42-123"><a href="#cb42-123" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb42-124"><a href="#cb42-124" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb42-125"><a href="#cb42-125" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb42-126"><a href="#cb42-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-127"><a href="#cb42-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-128"><a href="#cb42-128" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data structure and exploration</span></span>
<span id="cb42-129"><a href="#cb42-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-132"><a href="#cb42-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-133"><a href="#cb42-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data structure exploration</span></span>
<span id="cb42-134"><a href="#cb42-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb42-135"><a href="#cb42-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-136"><a href="#cb42-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-137"><a href="#cb42-137" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span>
<span id="cb42-138"><a href="#cb42-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-139"><a href="#cb42-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-140"><a href="#cb42-140" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-141"><a href="#cb42-141" aria-hidden="true" tabindex="-1"></a>The structure of the data shows that 'years_working', 'phys_activity' and 'quality of life' are numeric variables while 'obesity' is a factor with two levels.</span>
<span id="cb42-142"><a href="#cb42-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-143"><a href="#cb42-143" aria-hidden="true" tabindex="-1"></a><span class="fu">### Label variables</span></span>
<span id="cb42-144"><a href="#cb42-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-145"><a href="#cb42-145" aria-hidden="true" tabindex="-1"></a>The variables were labeled for clarity as follows: </span>
<span id="cb42-146"><a href="#cb42-146" aria-hidden="true" tabindex="-1"></a>years_working as "Years of Working", phys_activity as "Physical Activity Score", obesity as "Obesity Status", and qol as "Quality of Life".</span>
<span id="cb42-147"><a href="#cb42-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-150"><a href="#cb42-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-151"><a href="#cb42-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: label-variables</span></span>
<span id="cb42-152"><a href="#cb42-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb42-153"><a href="#cb42-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-154"><a href="#cb42-154" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>years_working) <span class="ot">&lt;-</span> <span class="st">"Years of Working"</span></span>
<span id="cb42-155"><a href="#cb42-155" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>phys_activity) <span class="ot">&lt;-</span> <span class="st">"Physical Activity Score"</span></span>
<span id="cb42-156"><a href="#cb42-156" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>obesity) <span class="ot">&lt;-</span> <span class="st">"Obesity Status"</span></span>
<span id="cb42-157"><a href="#cb42-157" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df<span class="sc">$</span>qol) <span class="ot">&lt;-</span> <span class="st">"Quality of Life"</span></span>
<span id="cb42-158"><a href="#cb42-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-159"><a href="#cb42-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-160"><a href="#cb42-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-161"><a href="#cb42-161" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part B: Exploratory Data Analysis</span></span>
<span id="cb42-162"><a href="#cb42-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-163"><a href="#cb42-163" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive statistics</span></span>
<span id="cb42-164"><a href="#cb42-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-165"><a href="#cb42-165" aria-hidden="true" tabindex="-1"></a>We inspect the central tendency and dispersion of the variables.</span>
<span id="cb42-166"><a href="#cb42-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-169"><a href="#cb42-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-170"><a href="#cb42-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: summary-stats</span></span>
<span id="cb42-171"><a href="#cb42-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Summary Statistics"</span></span>
<span id="cb42-172"><a href="#cb42-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-173"><a href="#cb42-173" aria-hidden="true" tabindex="-1"></a><span class="co">#descriptive analysis</span></span>
<span id="cb42-174"><a href="#cb42-174" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(df[,<span class="fu">c</span>(<span class="st">"qol"</span>,<span class="st">"years_working"</span>,<span class="st">"phys_activity"</span>,<span class="st">"obesity"</span>)],  </span>
<span id="cb42-175"><a href="#cb42-175" aria-hidden="true" tabindex="-1"></a>                <span class="at">style        =</span> <span class="st">"grid"</span>,  </span>
<span id="cb42-176"><a href="#cb42-176" aria-hidden="true" tabindex="-1"></a>                <span class="at">varnumbers   =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-177"><a href="#cb42-177" aria-hidden="true" tabindex="-1"></a>                <span class="at">valid.col    =</span> <span class="cn">FALSE</span></span>
<span id="cb42-178"><a href="#cb42-178" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb42-179"><a href="#cb42-179" aria-hidden="true" tabindex="-1"></a><span class="at">method =</span> <span class="st">"render"</span>)</span>
<span id="cb42-180"><a href="#cb42-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-181"><a href="#cb42-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-182"><a href="#cb42-182" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-183"><a href="#cb42-183" aria-hidden="true" tabindex="-1"></a>Outcome Variable (Quality of Life):</span>
<span id="cb42-184"><a href="#cb42-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-185"><a href="#cb42-185" aria-hidden="true" tabindex="-1"></a>The average Quality of Life (QOL) score is 58.1 ($SD = 13.7$), ranging from a low of 26.8 to a high of 90.2. The graph suggests the scores are relatively normally distributed (bell-shaped) around the mean.</span>
<span id="cb42-186"><a href="#cb42-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-187"><a href="#cb42-187" aria-hidden="true" tabindex="-1"></a>Continuous Predictors:</span>
<span id="cb42-188"><a href="#cb42-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-189"><a href="#cb42-189" aria-hidden="true" tabindex="-1"></a>Years Working: Participants have worked for an average of 20.3 years ($SD = 11.0$), spanning a full range from new entrants (0 years) to those with near-maximum tenure (39.8 years). The small histogram shows a fairly flat (uniform) distribution, meaning there is a good mix of people with different experience levels.</span>
<span id="cb42-190"><a href="#cb42-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-191"><a href="#cb42-191" aria-hidden="true" tabindex="-1"></a>Physical Activity: The mean physical activity score is 4.9 ($SD = 2.9$) on a scale of 0–10. Similar to years working, this variable covers the full range (0.1 to 10) and is widely distributed.</span>
<span id="cb42-192"><a href="#cb42-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-193"><a href="#cb42-193" aria-hidden="true" tabindex="-1"></a>Categorical Predictor :</span>
<span id="cb42-194"><a href="#cb42-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-195"><a href="#cb42-195" aria-hidden="true" tabindex="-1"></a>Obesity:The sample is predominantly non-obese, with 69.5% ($n=139$) classified as "not obese" and 30.5% ($n=61$) classified as "obese." This provides a sufficient sample size in both groups to compare differences.</span>
<span id="cb42-196"><a href="#cb42-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-197"><a href="#cb42-197" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualizations</span></span>
<span id="cb42-198"><a href="#cb42-198" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histograms for Continuous Variables</span></span>
<span id="cb42-199"><a href="#cb42-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-202"><a href="#cb42-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-203"><a href="#cb42-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: histograms</span></span>
<span id="cb42-204"><a href="#cb42-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of Continuous Variables"</span></span>
<span id="cb42-205"><a href="#cb42-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-206"><a href="#cb42-206" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb42-207"><a href="#cb42-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(qol, years_working, phys_activity) <span class="sc">%&gt;%</span></span>
<span id="cb42-208"><a href="#cb42-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-209"><a href="#cb42-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Value)) <span class="sc">+</span></span>
<span id="cb42-210"><a href="#cb42-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb42-211"><a href="#cb42-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb42-212"><a href="#cb42-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-213"><a href="#cb42-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histograms of Continuous Variables"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)</span>
<span id="cb42-214"><a href="#cb42-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-215"><a href="#cb42-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-216"><a href="#cb42-216" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb42-217"><a href="#cb42-217" aria-hidden="true" tabindex="-1"></a>The Physical Activity score and years of working exhibit approximately symmetric distributions. In contrast, the QoL scores demonstrate a pronounced right skew (concentration of values at the lower end). This skewness suggests that while most participants reported moderate quality of life, some participants have relatively good quality of life. </span>
<span id="cb42-218"><a href="#cb42-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-219"><a href="#cb42-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-220"><a href="#cb42-220" aria-hidden="true" tabindex="-1"></a><span class="fu">### Box Plots by Categorical Variable (Obesity)</span></span>
<span id="cb42-221"><a href="#cb42-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-224"><a href="#cb42-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-225"><a href="#cb42-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: boxplots</span></span>
<span id="cb42-226"><a href="#cb42-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Box Plots by Obesity Status"</span></span>
<span id="cb42-227"><a href="#cb42-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-228"><a href="#cb42-228" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb42-229"><a href="#cb42-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(obesity, qol, years_working, phys_activity) <span class="sc">%&gt;%</span></span>
<span id="cb42-230"><a href="#cb42-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>obesity, <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-231"><a href="#cb42-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">y =</span> Value, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb42-232"><a href="#cb42-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb42-233"><a href="#cb42-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variable, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb42-234"><a href="#cb42-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-235"><a href="#cb42-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plots by Obesity Status"</span>)</span>
<span id="cb42-236"><a href="#cb42-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-237"><a href="#cb42-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-238"><a href="#cb42-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-239"><a href="#cb42-239" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-240"><a href="#cb42-240" aria-hidden="true" tabindex="-1"></a>The box plot confirms a distinct separation between groups specifically in quality of life subgroup. The non-obese group exhibits a substantially higher median and elevated interquartile range compared to the obese group. However, there are no noticeable difference in the physical activity and years of working subgroups (overlapped box plots)</span>
<span id="cb42-241"><a href="#cb42-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-242"><a href="#cb42-242" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scatter Plots (QoL vs. Predictors)</span></span>
<span id="cb42-243"><a href="#cb42-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-246"><a href="#cb42-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-247"><a href="#cb42-247" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: scatterplots</span></span>
<span id="cb42-248"><a href="#cb42-248" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Relationships between Continuous Variables"</span></span>
<span id="cb42-249"><a href="#cb42-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-250"><a href="#cb42-250" aria-hidden="true" tabindex="-1"></a><span class="co"># QoL vs Years Working</span></span>
<span id="cb42-251"><a href="#cb42-251" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> years_working, <span class="at">y =</span> qol)) <span class="sc">+</span></span>
<span id="cb42-252"><a href="#cb42-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb42-253"><a href="#cb42-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb42-254"><a href="#cb42-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-255"><a href="#cb42-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QoL vs Years Working"</span>)</span>
<span id="cb42-256"><a href="#cb42-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-257"><a href="#cb42-257" aria-hidden="true" tabindex="-1"></a><span class="co"># QoL vs Physical Activity (colored by Obesity to see interaction)</span></span>
<span id="cb42-258"><a href="#cb42-258" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> phys_activity, <span class="at">y =</span> qol)) <span class="sc">+</span></span>
<span id="cb42-259"><a href="#cb42-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb42-260"><a href="#cb42-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb42-261"><a href="#cb42-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-262"><a href="#cb42-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QoL vs Physical Activity "</span>)</span>
<span id="cb42-263"><a href="#cb42-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-264"><a href="#cb42-264" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb42-265"><a href="#cb42-265" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb42-266"><a href="#cb42-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-267"><a href="#cb42-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-268"><a href="#cb42-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-269"><a href="#cb42-269" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb42-270"><a href="#cb42-270" aria-hidden="true" tabindex="-1"></a>Years working shows a negative correlation with QOL , while physical activity shows a positive linear relationship.</span>
<span id="cb42-271"><a href="#cb42-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-272"><a href="#cb42-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-273"><a href="#cb42-273" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlation Matrix </span></span>
<span id="cb42-274"><a href="#cb42-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-277"><a href="#cb42-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-278"><a href="#cb42-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: correlation</span></span>
<span id="cb42-279"><a href="#cb42-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Correlation Matrix"</span></span>
<span id="cb42-280"><a href="#cb42-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-281"><a href="#cb42-281" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only numeric columns</span></span>
<span id="cb42-282"><a href="#cb42-282" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(qol, years_working, phys_activity)</span>
<span id="cb42-283"><a href="#cb42-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-284"><a href="#cb42-284" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Correlation Matrix</span></span>
<span id="cb42-285"><a href="#cb42-285" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>()</span>
<span id="cb42-286"><a href="#cb42-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-287"><a href="#cb42-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-288"><a href="#cb42-288" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb42-289"><a href="#cb42-289" aria-hidden="true" tabindex="-1"></a>Strong Positive Relationship: There is a strong, highly significant correlation (0.718) between phys_activity and qol. This indicates that as physical activity increases, Quality of Life scores tend to rise substantially.</span>
<span id="cb42-290"><a href="#cb42-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-291"><a href="#cb42-291" aria-hidden="true" tabindex="-1"></a>Weak Negative Relationship: There is a weak negative correlation (-0.139) between years_working and qol. This suggests that longer work duration is associated with a slight decrease in Quality of Life, though the relationship is not very strong.</span>
<span id="cb42-292"><a href="#cb42-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-293"><a href="#cb42-293" aria-hidden="true" tabindex="-1"></a>Independence of Predictors: The correlation between years_working and phys_activity is negligible (-0.052). This confirms that there is no linear relationship between these two independent variables, meaning multicollinearity is not a concern for the regression model.</span>
<span id="cb42-294"><a href="#cb42-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-295"><a href="#cb42-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-296"><a href="#cb42-296" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part C: Regression Analysis</span></span>
<span id="cb42-297"><a href="#cb42-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-298"><a href="#cb42-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Univariable analysis</span></span>
<span id="cb42-299"><a href="#cb42-299" aria-hidden="true" tabindex="-1"></a>We first assess the individual association of each predictor with QOL.</span>
<span id="cb42-300"><a href="#cb42-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-301"><a href="#cb42-301" aria-hidden="true" tabindex="-1"></a><span class="fu">### Years of working</span></span>
<span id="cb42-302"><a href="#cb42-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-305"><a href="#cb42-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-306"><a href="#cb42-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: univariable-years-working</span></span>
<span id="cb42-307"><a href="#cb42-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb42-308"><a href="#cb42-308" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Univariable Model - Years of Working"</span></span>
<span id="cb42-309"><a href="#cb42-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-310"><a href="#cb42-310" aria-hidden="true" tabindex="-1"></a>mod_year <span class="ot">&lt;-</span><span class="fu">lm</span>(qol<span class="sc">~</span> years_working, <span class="at">data=</span> df)</span>
<span id="cb42-311"><a href="#cb42-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-312"><a href="#cb42-312" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_year, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-313"><a href="#cb42-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-314"><a href="#cb42-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-315"><a href="#cb42-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb42-316"><a href="#cb42-316" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 1: Univariable Model - Years of Working"</span></span>
<span id="cb42-317"><a href="#cb42-317" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-318"><a href="#cb42-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-319"><a href="#cb42-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-320"><a href="#cb42-320" aria-hidden="true" tabindex="-1"></a><span class="fu">### Physical activity</span></span>
<span id="cb42-321"><a href="#cb42-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-324"><a href="#cb42-324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-325"><a href="#cb42-325" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: univariable-phys-activity</span></span>
<span id="cb42-326"><a href="#cb42-326" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb42-327"><a href="#cb42-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Univariable Model - Physical Activity"</span></span>
<span id="cb42-328"><a href="#cb42-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-329"><a href="#cb42-329" aria-hidden="true" tabindex="-1"></a>mod_pa<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity, <span class="at">data=</span> df)</span>
<span id="cb42-330"><a href="#cb42-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-331"><a href="#cb42-331" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_pa, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-332"><a href="#cb42-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-333"><a href="#cb42-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-334"><a href="#cb42-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb42-335"><a href="#cb42-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 2: Univariable Model - Physical Activity"</span></span>
<span id="cb42-336"><a href="#cb42-336" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-337"><a href="#cb42-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-338"><a href="#cb42-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-339"><a href="#cb42-339" aria-hidden="true" tabindex="-1"></a><span class="fu">### Obesity</span></span>
<span id="cb42-340"><a href="#cb42-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-343"><a href="#cb42-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-344"><a href="#cb42-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: univariable-obesity</span></span>
<span id="cb42-345"><a href="#cb42-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb42-346"><a href="#cb42-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Univariable Model - Obesity"</span></span>
<span id="cb42-347"><a href="#cb42-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-348"><a href="#cb42-348" aria-hidden="true" tabindex="-1"></a>mod_obs<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> obesity, <span class="at">data=</span> df)</span>
<span id="cb42-349"><a href="#cb42-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-350"><a href="#cb42-350" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_obs, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-351"><a href="#cb42-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-352"><a href="#cb42-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-353"><a href="#cb42-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb42-354"><a href="#cb42-354" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 3: Univariable Model - Obesity"</span></span>
<span id="cb42-355"><a href="#cb42-355" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-356"><a href="#cb42-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-357"><a href="#cb42-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-358"><a href="#cb42-358" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-359"><a href="#cb42-359" aria-hidden="true" tabindex="-1"></a>Physical activity and obesity status are significantly associated with QOL(p values: &lt;0.05). Whereas years of working is marginally related to quality of life (p value:0.05).</span>
<span id="cb42-360"><a href="#cb42-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-361"><a href="#cb42-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-362"><a href="#cb42-362" aria-hidden="true" tabindex="-1"></a><span class="fu">## Handling potential confounder</span></span>
<span id="cb42-365"><a href="#cb42-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-366"><a href="#cb42-366" aria-hidden="true" tabindex="-1"></a>mod_pa<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity, <span class="at">data=</span> df)</span>
<span id="cb42-367"><a href="#cb42-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-368"><a href="#cb42-368" aria-hidden="true" tabindex="-1"></a>mod_pa_years<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity <span class="sc">+</span> years_working, <span class="at">data=</span> df)</span>
<span id="cb42-369"><a href="#cb42-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-370"><a href="#cb42-370" aria-hidden="true" tabindex="-1"></a>mod_pa_obs<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity <span class="sc">+</span> obesity, <span class="at">data=</span> df)</span>
<span id="cb42-371"><a href="#cb42-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-372"><a href="#cb42-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-373"><a href="#cb42-373" aria-hidden="true" tabindex="-1"></a>coef_pa <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod_pa)<span class="sc">$</span>estimate[<span class="dv">2</span>]</span>
<span id="cb42-374"><a href="#cb42-374" aria-hidden="true" tabindex="-1"></a>coef_pa_years <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod_pa_years)<span class="sc">$</span>estimate[<span class="dv">2</span>]</span>
<span id="cb42-375"><a href="#cb42-375" aria-hidden="true" tabindex="-1"></a>coef_pa_obs <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod_pa_obs)<span class="sc">$</span>estimate[<span class="dv">2</span>]</span>
<span id="cb42-376"><a href="#cb42-376" aria-hidden="true" tabindex="-1"></a>percent_change_year <span class="ot">&lt;-</span> ((coef_pa <span class="sc">-</span> coef_pa_years) <span class="sc">/</span> coef_pa) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb42-377"><a href="#cb42-377" aria-hidden="true" tabindex="-1"></a>percent_change_obs <span class="ot">&lt;-</span> ((coef_pa <span class="sc">-</span> coef_pa_obs) <span class="sc">/</span> coef_pa) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb42-378"><a href="#cb42-378" aria-hidden="true" tabindex="-1"></a>percent_change_year</span>
<span id="cb42-379"><a href="#cb42-379" aria-hidden="true" tabindex="-1"></a>percent_change_obs</span>
<span id="cb42-380"><a href="#cb42-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-381"><a href="#cb42-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-382"><a href="#cb42-382" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb42-383"><a href="#cb42-383" aria-hidden="true" tabindex="-1"></a>The change in the coefficient for physical activity when adjusting for years_working and obesity is relatively small (less than 20%). This suggests that while years_working and obesity are independent predictors of QoL, they do not act as confounders for the relationship between physical activity and QoL.</span>
<span id="cb42-384"><a href="#cb42-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-385"><a href="#cb42-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-386"><a href="#cb42-386" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multivariable analysis</span></span>
<span id="cb42-387"><a href="#cb42-387" aria-hidden="true" tabindex="-1"></a>We fit two models:</span>
<span id="cb42-388"><a href="#cb42-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-389"><a href="#cb42-389" aria-hidden="true" tabindex="-1"></a><span class="fu">### model 1: full model (main effects only).</span></span>
<span id="cb42-390"><a href="#cb42-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-393"><a href="#cb42-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-394"><a href="#cb42-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: full model</span></span>
<span id="cb42-395"><a href="#cb42-395" aria-hidden="true" tabindex="-1"></a>mod_full<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> obesity <span class="sc">+</span> phys_activity <span class="sc">+</span> years_working, <span class="at">data=</span> df)</span>
<span id="cb42-396"><a href="#cb42-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-397"><a href="#cb42-397" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_full, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-398"><a href="#cb42-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-399"><a href="#cb42-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-400"><a href="#cb42-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb42-401"><a href="#cb42-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 6: Full Model (main effects only)"</span></span>
<span id="cb42-402"><a href="#cb42-402" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-403"><a href="#cb42-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-404"><a href="#cb42-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-405"><a href="#cb42-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-406"><a href="#cb42-406" aria-hidden="true" tabindex="-1"></a><span class="fu">### model 2: full model + interaction between physical activity and obesity.</span></span>
<span id="cb42-407"><a href="#cb42-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-410"><a href="#cb42-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-411"><a href="#cb42-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: full model + intreraction between physical activity and obesity</span></span>
<span id="cb42-412"><a href="#cb42-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-413"><a href="#cb42-413" aria-hidden="true" tabindex="-1"></a>mod_pa.obs<span class="ot">&lt;-</span> <span class="fu">lm</span>(qol<span class="sc">~</span> phys_activity <span class="sc">+</span> years_working <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity<span class="sc">:</span>obesity, <span class="at">data=</span> df)</span>
<span id="cb42-414"><a href="#cb42-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-415"><a href="#cb42-415" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mod_pa.obs, <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-416"><a href="#cb42-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-417"><a href="#cb42-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-418"><a href="#cb42-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb42-419"><a href="#cb42-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 7: Full Model + Interaction Term"</span></span>
<span id="cb42-420"><a href="#cb42-420" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-421"><a href="#cb42-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-422"><a href="#cb42-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-423"><a href="#cb42-423" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model comparison</span></span>
<span id="cb42-424"><a href="#cb42-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-427"><a href="#cb42-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-428"><a href="#cb42-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model-comparison</span></span>
<span id="cb42-429"><a href="#cb42-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-430"><a href="#cb42-430" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood Ratio Test</span></span>
<span id="cb42-431"><a href="#cb42-431" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_full, mod_pa.obs)</span>
<span id="cb42-432"><a href="#cb42-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-433"><a href="#cb42-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-434"><a href="#cb42-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-435"><a href="#cb42-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-436"><a href="#cb42-436" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-437"><a href="#cb42-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-438"><a href="#cb42-438" aria-hidden="true" tabindex="-1"></a>Model Comparison: Why Model 2 is Better</span>
<span id="cb42-439"><a href="#cb42-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-440"><a href="#cb42-440" aria-hidden="true" tabindex="-1"></a>The Analysis of Variance (ANOVA) table provides strong statistical evidence that Model 2 (Table 7; with interaction) is superior to Model 1 (Table 6; main effects only).</span>
<span id="cb42-441"><a href="#cb42-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-442"><a href="#cb42-442" aria-hidden="true" tabindex="-1"></a>Lower Residual Sum of Squares (RSS): Model 2 has a lower RSS (5063.1) compared to Model 1 (5932.4). A lower RSS indicates that Model 2 has smaller prediction errors and fits the observed data more closely than Model 1.</span>
<span id="cb42-443"><a href="#cb42-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-444"><a href="#cb42-444" aria-hidden="true" tabindex="-1"></a>Statistically Significant Improvement: The ANOVA comparison shows a highly significant p-value (2.834e-08, denoted as ***), which confirms that the reduction in error (RSS) achieved by adding the interaction term is statistically significant.</span>
<span id="cb42-445"><a href="#cb42-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-446"><a href="#cb42-446" aria-hidden="true" tabindex="-1"></a>Improved Explanatory Power ($R^2$): The performance table confirms that Model 2 explains a higher proportion of the variance in the data ($R^2$ = 0.864) compared to Model 1 ($R^2$ = 0.841).</span>
<span id="cb42-447"><a href="#cb42-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-448"><a href="#cb42-448" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part D: Model Checking</span></span>
<span id="cb42-449"><a href="#cb42-449" aria-hidden="true" tabindex="-1"></a>We perform diagnostics on Model 2 to check assumptions and identify influential outliers</span>
<span id="cb42-450"><a href="#cb42-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-451"><a href="#cb42-451" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check assumptions</span></span>
<span id="cb42-452"><a href="#cb42-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-453"><a href="#cb42-453" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linearity </span></span>
<span id="cb42-454"><a href="#cb42-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-457"><a href="#cb42-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-458"><a href="#cb42-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: linearity </span></span>
<span id="cb42-459"><a href="#cb42-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb42-460"><a href="#cb42-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-461"><a href="#cb42-461" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb42-462"><a href="#cb42-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-463"><a href="#cb42-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-464"><a href="#cb42-464" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-465"><a href="#cb42-465" aria-hidden="true" tabindex="-1"></a>The Residuals vs Fitted plot confirms the linearity assumption is satisfied, as the red smoothing line is horizontal and centers closely on zero across the entire range of fitted values. This indicates no non-linear patterns, such as U-shapes or curves, suggesting the linear model appropriately captures the relationship between the predictors and the outcome.</span>
<span id="cb42-466"><a href="#cb42-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-467"><a href="#cb42-467" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normality of residuals</span></span>
<span id="cb42-468"><a href="#cb42-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-471"><a href="#cb42-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-472"><a href="#cb42-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: normality of residuals </span></span>
<span id="cb42-473"><a href="#cb42-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb42-474"><a href="#cb42-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-475"><a href="#cb42-475" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb42-476"><a href="#cb42-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-477"><a href="#cb42-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-478"><a href="#cb42-478" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb42-479"><a href="#cb42-479" aria-hidden="true" tabindex="-1"></a>While central points align with the diagonal, there are some slight deviations in the tails and head (e.g 71,156, 116). </span>
<span id="cb42-480"><a href="#cb42-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-481"><a href="#cb42-481" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homocedasticity (Scale-Location)</span></span>
<span id="cb42-482"><a href="#cb42-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-485"><a href="#cb42-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-486"><a href="#cb42-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: homocedasticity (scale-location)</span></span>
<span id="cb42-487"><a href="#cb42-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb42-488"><a href="#cb42-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-489"><a href="#cb42-489" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb42-490"><a href="#cb42-490" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb42-491"><a href="#cb42-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-492"><a href="#cb42-492" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb42-493"><a href="#cb42-493" aria-hidden="true" tabindex="-1"></a>A slight trend is visible, but no severe convergence or divergence is observed. This suggests that variance is relatively constant.</span>
<span id="cb42-494"><a href="#cb42-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-495"><a href="#cb42-495" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independence of residues</span></span>
<span id="cb42-496"><a href="#cb42-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-499"><a href="#cb42-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-500"><a href="#cb42-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Independence of residues</span></span>
<span id="cb42-501"><a href="#cb42-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-502"><a href="#cb42-502" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(mod_pa.obs)</span>
<span id="cb42-503"><a href="#cb42-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-504"><a href="#cb42-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-505"><a href="#cb42-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-506"><a href="#cb42-506" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-507"><a href="#cb42-507" aria-hidden="true" tabindex="-1"></a>The Durbin-Watson test ($p &gt; 0.05$) suggests no significant autocorrelation.</span>
<span id="cb42-508"><a href="#cb42-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-509"><a href="#cb42-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-510"><a href="#cb42-510" aria-hidden="true" tabindex="-1"></a><span class="fu">## Influential Analysis</span></span>
<span id="cb42-511"><a href="#cb42-511" aria-hidden="true" tabindex="-1"></a>We identify influential points using Cook's Distance, DFBETAS, and Leverage.</span>
<span id="cb42-512"><a href="#cb42-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-513"><a href="#cb42-513" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cook's Distance </span></span>
<span id="cb42-514"><a href="#cb42-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-517"><a href="#cb42-517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-518"><a href="#cb42-518" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Cook's Distance</span></span>
<span id="cb42-519"><a href="#cb42-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-520"><a href="#cb42-520" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb42-521"><a href="#cb42-521" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">nrow</span>(df)</span>
<span id="cb42-522"><a href="#cb42-522" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which =</span> <span class="dv">4</span>, <span class="at">cook.levels =</span> cutoff)</span>
<span id="cb42-523"><a href="#cb42-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-524"><a href="#cb42-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-525"><a href="#cb42-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-526"><a href="#cb42-526" aria-hidden="true" tabindex="-1"></a>*Interpretation*: </span>
<span id="cb42-527"><a href="#cb42-527" aria-hidden="true" tabindex="-1"></a>This plot measures the overall influence of each observation on the model's fitted values.</span>
<span id="cb42-528"><a href="#cb42-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-529"><a href="#cb42-529" aria-hidden="true" tabindex="-1"></a>Observation 127 has the highest spike (Cook's distance $\approx 0.10$), followed by observations 156 and 72. Since all values are well below the conventional threshold of 1 (and generally low even for stricter thresholds like $4/n$), these points are influential but not problematic enough to invalidate the model.</span>
<span id="cb42-530"><a href="#cb42-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-531"><a href="#cb42-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-532"><a href="#cb42-532" aria-hidden="true" tabindex="-1"></a><span class="fu">### Leverage Points</span></span>
<span id="cb42-533"><a href="#cb42-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-536"><a href="#cb42-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-537"><a href="#cb42-537" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Leverage Points</span></span>
<span id="cb42-538"><a href="#cb42-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-539"><a href="#cb42-539" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pa.obs, <span class="at">which=</span><span class="dv">5</span>)</span>
<span id="cb42-540"><a href="#cb42-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-541"><a href="#cb42-541" aria-hidden="true" tabindex="-1"></a>*Interpretation*: </span>
<span id="cb42-542"><a href="#cb42-542" aria-hidden="true" tabindex="-1"></a>This plot helps identify influential data points by comparing standardized residuals against leverage (how extreme the predictor values are).</span>
<span id="cb42-543"><a href="#cb42-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-544"><a href="#cb42-544" aria-hidden="true" tabindex="-1"></a>Most data points cluster to the left, indicating low leverage. Observation 127 stands out in the upper right corner, meaning it has both high leverage and a relatively large residual. However, it does not cross the critical Cook's distance contours (the dashed lines usually set at 0.5 or 1), suggesting it is not severely distorting the model despite being an outlier.</span>
<span id="cb42-545"><a href="#cb42-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-546"><a href="#cb42-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-547"><a href="#cb42-547" aria-hidden="true" tabindex="-1"></a><span class="fu">### DFBETAS </span></span>
<span id="cb42-548"><a href="#cb42-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-551"><a href="#cb42-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-552"><a href="#cb42-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: DFBETAS</span></span>
<span id="cb42-553"><a href="#cb42-553" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb42-554"><a href="#cb42-554" aria-hidden="true" tabindex="-1"></a><span class="fu">dfbetaPlots</span>(mod_pa.obs)</span>
<span id="cb42-555"><a href="#cb42-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-556"><a href="#cb42-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-557"><a href="#cb42-557" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-558"><a href="#cb42-558" aria-hidden="true" tabindex="-1"></a>This plot shows how much each regression coefficient would change if a single observation were removed.</span>
<span id="cb42-559"><a href="#cb42-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-560"><a href="#cb42-560" aria-hidden="true" tabindex="-1"></a>The scatterplots for all four terms (phys_activity, years_working, obesity, and the interaction) show random patterns centered around zero. There are no extreme spikes exceeding standard thresholds, confirming that the estimated coefficients are stable and not driven by any single data point.</span>
<span id="cb42-561"><a href="#cb42-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-562"><a href="#cb42-562" aria-hidden="true" tabindex="-1"></a><span class="fu">## Remedial Measures</span></span>
<span id="cb42-563"><a href="#cb42-563" aria-hidden="true" tabindex="-1"></a>We remove the identified influential observations and refit the model</span>
<span id="cb42-564"><a href="#cb42-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-565"><a href="#cb42-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove influential observations and refit the model</span></span>
<span id="cb42-566"><a href="#cb42-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-569"><a href="#cb42-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-570"><a href="#cb42-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: illustrate-cooks-distance</span></span>
<span id="cb42-571"><a href="#cb42-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Identifying Influential Observations for Removal"</span></span>
<span id="cb42-572"><a href="#cb42-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-573"><a href="#cb42-573" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cutoff for influential points (Cook's Distance)</span></span>
<span id="cb42-574"><a href="#cb42-574" aria-hidden="true" tabindex="-1"></a><span class="co"># A common threshold is 4/n, where n is the number of observations</span></span>
<span id="cb42-575"><a href="#cb42-575" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(df)</span>
<span id="cb42-576"><a href="#cb42-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-577"><a href="#cb42-577" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_pa.obs, df) <span class="sc">%&gt;%</span></span>
<span id="cb42-578"><a href="#cb42-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">ifelse</span>(.cooksd <span class="sc">&gt;</span> cutoff, <span class="st">"Influential (Remove)"</span>, <span class="st">"Normal (Keep)"</span>))</span>
<span id="cb42-579"><a href="#cb42-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-580"><a href="#cb42-580" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> .cooksd, <span class="at">fill =</span> Status)) <span class="sc">+</span></span>
<span id="cb42-581"><a href="#cb42-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span>      </span>
<span id="cb42-582"><a href="#cb42-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> cutoff, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb42-583"><a href="#cb42-583" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-584"><a href="#cb42-584" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-585"><a href="#cb42-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Influential (Remove)"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>, <span class="st">"Normal (Keep)"</span> <span class="ot">=</span> <span class="st">"gray70"</span>)) <span class="sc">+</span></span>
<span id="cb42-586"><a href="#cb42-586" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-587"><a href="#cb42-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-588"><a href="#cb42-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook's Distance: Selection of Points for Removal"</span>,</span>
<span id="cb42-589"><a href="#cb42-589" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Red dashed line indicates cutoff threshold:"</span>, <span class="fu">round</span>(cutoff, <span class="dv">4</span>)),</span>
<span id="cb42-590"><a href="#cb42-590" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Observation ID"</span>,</span>
<span id="cb42-591"><a href="#cb42-591" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cook's Distance"</span>) <span class="sc">+</span></span>
<span id="cb42-592"><a href="#cb42-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-593"><a href="#cb42-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb42-594"><a href="#cb42-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-595"><a href="#cb42-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-596"><a href="#cb42-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-599"><a href="#cb42-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-600"><a href="#cb42-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: refit-model</span></span>
<span id="cb42-601"><a href="#cb42-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-602"><a href="#cb42-602" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(df)</span>
<span id="cb42-603"><a href="#cb42-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-604"><a href="#cb42-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Augment the model to get Cook's Distance (.cooksd) for every point</span></span>
<span id="cb42-605"><a href="#cb42-605" aria-hidden="true" tabindex="-1"></a>df_augmented <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_pa.obs, df)</span>
<span id="cb42-606"><a href="#cb42-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-607"><a href="#cb42-607" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out points that exceed the cutoff</span></span>
<span id="cb42-608"><a href="#cb42-608" aria-hidden="true" tabindex="-1"></a><span class="co"># We keep rows where .cooksd is LESS than the cutoff</span></span>
<span id="cb42-609"><a href="#cb42-609" aria-hidden="true" tabindex="-1"></a>df_no_outliers <span class="ot">&lt;-</span> df_augmented <span class="sc">%&gt;%</span> </span>
<span id="cb42-610"><a href="#cb42-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&lt;</span> cutoff)</span>
<span id="cb42-611"><a href="#cb42-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-612"><a href="#cb42-612" aria-hidden="true" tabindex="-1"></a><span class="co"># Refit the model using this cleaned dataset</span></span>
<span id="cb42-613"><a href="#cb42-613" aria-hidden="true" tabindex="-1"></a>mod_pa.obs_refit <span class="ot">&lt;-</span> <span class="fu">lm</span>(qol <span class="sc">~</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> years_working <span class="sc">+</span> phys_activity<span class="sc">:</span>obesity, <span class="at">data =</span> df_no_outliers)</span>
<span id="cb42-614"><a href="#cb42-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-615"><a href="#cb42-615" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize and compare</span></span>
<span id="cb42-616"><a href="#cb42-616" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_pa.obs_refit)</span>
<span id="cb42-617"><a href="#cb42-617" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(mod_pa.obs, mod_pa.obs_refit, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-618"><a href="#cb42-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-619"><a href="#cb42-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-620"><a href="#cb42-620" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-621"><a href="#cb42-621" aria-hidden="true" tabindex="-1"></a>Removing the influential observations identified by Cook's Distance didn't drastically change the results, which confirms that our original model was solid to begin with.</span>
<span id="cb42-622"><a href="#cb42-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-623"><a href="#cb42-623" aria-hidden="true" tabindex="-1"></a>Coefficient Stability: The estimates for the predictors were very stable. For example, the effect of physical activity remained virtually unchanged (Original $\beta = 3.6$ vs. Refitted $\beta = 3.60$). </span>
<span id="cb42-624"><a href="#cb42-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-625"><a href="#cb42-625" aria-hidden="true" tabindex="-1"></a>Crucially, the interaction term also stayed almost exactly the same, shifting only slightly from -1.6 to -1.63.</span>
<span id="cb42-626"><a href="#cb42-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-627"><a href="#cb42-627" aria-hidden="true" tabindex="-1"></a>Model Fit ($R^2$): We did see an improvement in how well the model fits the data. The Adjusted $R^2$ rose from 0.862 to 0.890, and the prediction error (RMSE) dropped from 5.031 to 4.332. This suggests that the influential points were adding some "noise" to the model, but taking them out didn't change the underlying trends.</span>
<span id="cb42-628"><a href="#cb42-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-629"><a href="#cb42-629" aria-hidden="true" tabindex="-1"></a>Conclusion:This sensitivity analysis gives us confidence in the results. It proves that the relationships we found, specifically the interaction between obesity and physical activity,are real and reliable, rather than being driven by a handful of extreme cases.</span>
<span id="cb42-630"><a href="#cb42-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-631"><a href="#cb42-631" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part E: Results Presentation and Interpretation</span></span>
<span id="cb42-632"><a href="#cb42-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-633"><a href="#cb42-633" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final regression table</span></span>
<span id="cb42-634"><a href="#cb42-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-637"><a href="#cb42-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-638"><a href="#cb42-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Final Model</span></span>
<span id="cb42-639"><a href="#cb42-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-640"><a href="#cb42-640" aria-hidden="true" tabindex="-1"></a>final_tbl <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(</span>
<span id="cb42-641"><a href="#cb42-641" aria-hidden="true" tabindex="-1"></a>  mod_pa.obs,</span>
<span id="cb42-642"><a href="#cb42-642" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-643"><a href="#cb42-643" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb42-644"><a href="#cb42-644" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(<span class="at">years_working =</span> <span class="st">"Years of working"</span>,</span>
<span id="cb42-645"><a href="#cb42-645" aria-hidden="true" tabindex="-1"></a>               <span class="at">phys_activity =</span> <span class="st">"Physical activity"</span>,</span>
<span id="cb42-646"><a href="#cb42-646" aria-hidden="true" tabindex="-1"></a>               <span class="at">obesity =</span> <span class="st">"Obesity"</span>,</span>
<span id="cb42-647"><a href="#cb42-647" aria-hidden="true" tabindex="-1"></a>               <span class="at">qol =</span> <span class="st">"Quality of life"</span>),</span>
<span id="cb42-648"><a href="#cb42-648" aria-hidden="true" tabindex="-1"></a>  <span class="at">pvalue_fun =</span> <span class="sc">~</span><span class="fu">style_pvalue</span>(.x, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">eps =</span> <span class="fl">0.001</span>),</span>
<span id="cb42-649"><a href="#cb42-649" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate_fun =</span> <span class="sc">~</span><span class="fu">style_number</span>(.x, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb42-650"><a href="#cb42-650" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-651"><a href="#cb42-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_glance_table</span>(</span>
<span id="cb42-652"><a href="#cb42-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">include =</span> <span class="fu">c</span>(r.squared, adj.r.squared, statistic),</span>
<span id="cb42-653"><a href="#cb42-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">list</span>(<span class="at">statistic =</span> <span class="st">"F-statistic"</span>)</span>
<span id="cb42-654"><a href="#cb42-654" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-655"><a href="#cb42-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-656"><a href="#cb42-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-657"><a href="#cb42-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(</span>
<span id="cb42-658"><a href="#cb42-658" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"**Variables**"</span>,</span>
<span id="cb42-659"><a href="#cb42-659" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="st">"**Adj. Beta**"</span>,</span>
<span id="cb42-660"><a href="#cb42-660" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="st">"**SE**"</span>,</span>
<span id="cb42-661"><a href="#cb42-661" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="st">"**t-stat**"</span></span>
<span id="cb42-662"><a href="#cb42-662" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-663"><a href="#cb42-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_column_unhide</span>(<span class="fu">c</span>(std.error, statistic)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-664"><a href="#cb42-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_table_body</span>(</span>
<span id="cb42-665"><a href="#cb42-665" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> .x <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(std.error, <span class="at">.after =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb42-666"><a href="#cb42-666" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">relocate</span>(statistic, <span class="at">.before =</span> p.value)</span>
<span id="cb42-667"><a href="#cb42-667" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-668"><a href="#cb42-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Multivariable Linear Regression Model for Quality of Life Score (QOL)**"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb42-669"><a href="#cb42-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-670"><a href="#cb42-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_align_table_header</span>(<span class="at">align =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-671"><a href="#cb42-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb42-672"><a href="#cb42-672" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.style =</span> <span class="st">"none"</span>,</span>
<span id="cb42-673"><a href="#cb42-673" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.style =</span> <span class="st">"none"</span>,</span>
<span id="cb42-674"><a href="#cb42-674" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.border.bottom.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb42-675"><a href="#cb42-675" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb42-676"><a href="#cb42-676" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb42-677"><a href="#cb42-677" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.border.bottom.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb42-678"><a href="#cb42-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb42-679"><a href="#cb42-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.hlines.style =</span> <span class="st">"none"</span>,</span>
<span id="cb42-680"><a href="#cb42-680" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb42-681"><a href="#cb42-681" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="dv">2</span>),</span>
<span id="cb42-682"><a href="#cb42-682" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb42-683"><a href="#cb42-683" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb42-684"><a href="#cb42-684" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.width =</span> <span class="fu">px</span>(<span class="dv">2</span>),</span>
<span id="cb42-685"><a href="#cb42-685" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb42-686"><a href="#cb42-686" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">5</span>)</span>
<span id="cb42-687"><a href="#cb42-687" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-688"><a href="#cb42-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb42-689"><a href="#cb42-689" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"right"</span>),</span>
<span id="cb42-690"><a href="#cb42-690" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> <span class="sc">-</span>label)</span>
<span id="cb42-691"><a href="#cb42-691" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-692"><a href="#cb42-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_align_table_header</span>(<span class="at">align =</span> <span class="st">"left"</span>)</span>
<span id="cb42-693"><a href="#cb42-693" aria-hidden="true" tabindex="-1"></a>final_tbl</span>
<span id="cb42-694"><a href="#cb42-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-695"><a href="#cb42-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-696"><a href="#cb42-696" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final model equation</span></span>
<span id="cb42-697"><a href="#cb42-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-698"><a href="#cb42-698" aria-hidden="true" tabindex="-1"></a>The final linear regression model on quality of life is given by the equation:</span>
<span id="cb42-699"><a href="#cb42-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-700"><a href="#cb42-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-701"><a href="#cb42-701" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-702"><a href="#cb42-702" aria-hidden="true" tabindex="-1"></a>\text{QOL} = 50.59 </span>
<span id="cb42-703"><a href="#cb42-703" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>3.58 \space (\text{Physical Activity}) </span>
<span id="cb42-704"><a href="#cb42-704" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>0.24 \space (\text{Years Working}) </span>
<span id="cb42-705"><a href="#cb42-705" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>9.25 \space (\text{Obese}) </span>
<span id="cb42-706"><a href="#cb42-706" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>1.62 \space (\text{Physical Activity} \times \text{Obese}) </span>
<span id="cb42-707"><a href="#cb42-707" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\varepsilon</span>
<span id="cb42-708"><a href="#cb42-708" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-709"><a href="#cb42-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-710"><a href="#cb42-710" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb42-711"><a href="#cb42-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-712"><a href="#cb42-712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>QOL: Quality of Life score (outcome variable)</span>
<span id="cb42-713"><a href="#cb42-713" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Physical Activity: Physical activity score (predictor)</span>
<span id="cb42-714"><a href="#cb42-714" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Years Working: Number of years working (predictor)</span>
<span id="cb42-715"><a href="#cb42-715" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Obese: Indicator variable for obesity status (1 = obese, 0 = not</span>
<span id="cb42-716"><a href="#cb42-716" aria-hidden="true" tabindex="-1"></a>obese)</span>
<span id="cb42-717"><a href="#cb42-717" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\varepsilon$: Error term capturing unexplained variability</span>
<span id="cb42-718"><a href="#cb42-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-719"><a href="#cb42-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-720"><a href="#cb42-720" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interaction Plot </span></span>
<span id="cb42-723"><a href="#cb42-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-724"><a href="#cb42-724" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Interaction plot of the final model</span></span>
<span id="cb42-725"><a href="#cb42-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-726"><a href="#cb42-726" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(mod_pa.obs, <span class="at">pred =</span> phys_activity, <span class="at">modx =</span> obesity</span>
<span id="cb42-727"><a href="#cb42-727" aria-hidden="true" tabindex="-1"></a>              , <span class="at">plot.points =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-728"><a href="#cb42-728" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-729"><a href="#cb42-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-730"><a href="#cb42-730" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb42-731"><a href="#cb42-731" aria-hidden="true" tabindex="-1"></a>The interaction plot demonstrates significant effect modification, characterized by heterogeneity of regression slopes where the positive association between physical activity and QOL is attenuated in the obese group ($\beta \approx 2.0$) relative to the non-obese group ($\beta \approx 3.6$). This differential marginal effect confirms that while physical activity yields positive outcomes for all, the rate of improvement is statistically constrained by obesity status, resulting in a widening disparity at higher activity levels.</span>
<span id="cb42-732"><a href="#cb42-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-733"><a href="#cb42-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-734"><a href="#cb42-734" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation of Final Model Results</span></span>
<span id="cb42-735"><a href="#cb42-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-736"><a href="#cb42-736" aria-hidden="true" tabindex="-1"></a><span class="fu">### Main Effects and Interaction Terms</span></span>
<span id="cb42-737"><a href="#cb42-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-738"><a href="#cb42-738" aria-hidden="true" tabindex="-1"></a>The final model identifies several statistically significant predictors on quality of life:</span>
<span id="cb42-739"><a href="#cb42-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-740"><a href="#cb42-740" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Years Working**: There is a significant negative association between employment duration and quality of life ($\beta = -0.24, p &lt; 0.001$). For every additional year of working, the Quality of Life score decreases by 0.24 units.</span>
<span id="cb42-741"><a href="#cb42-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-742"><a href="#cb42-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-743"><a href="#cb42-743" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Physical Activity**: Physical activity is a strong positive predictor. For non-obese individuals (the reference group), each 1-unit increase in physical activity score is associated with a 3.6 unit increase in Quality of Life ($\beta = 3.6, p &lt; 0.001$).</span>
<span id="cb42-744"><a href="#cb42-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-745"><a href="#cb42-745" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Obesity**: Obesity is associated with a significantly lower baseline Quality of Life. When physical activity is zero, obese individuals have a Quality of Life score that is 9.3 points lower than non-obese individuals ($\beta = -9.3, p &lt; 0.001$).</span>
<span id="cb42-746"><a href="#cb42-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-747"><a href="#cb42-747" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interaction (Physical Activity × Obesity)**: The significant negative interaction term ($\beta = -1.6, p &lt; 0.001$) indicates that obesity dampens the beneficial effect of exercise. While physical activity improves Quality of Life for everyone, the rate of improvement is slower for obese individuals, who gain only 2.0 points ($3.6 - 1.6$) per unit of activity compared to 3.6 points for non-obese individuals.</span>
<span id="cb42-748"><a href="#cb42-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-749"><a href="#cb42-749" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Comparison</span></span>
<span id="cb42-750"><a href="#cb42-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-751"><a href="#cb42-751" aria-hidden="true" tabindex="-1"></a>Compared to the main effects model (Model 1), the final model including the interaction term (Model 2) demonstrates superior fit and explanatory power:</span>
<span id="cb42-752"><a href="#cb42-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-753"><a href="#cb42-753" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>**Statistical Significance**:The Analysis of Variance (ANOVA) comparison reveals that adding the interaction term significantly reduced the Residual Sum of Squares (RSS) from 5932.4 to 5063.1 ($F = 33.48, p &lt; 0.001$). This confirms that the interaction between physical activity and obesity provides a statistically significant improvement in predicting Quality of Life.</span>
<span id="cb42-754"><a href="#cb42-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-755"><a href="#cb42-755" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>**Explanatory Power**:The inclusion of the interaction term increased the $R^2$ from 0.841 to 0.864, indicating that the final model explains a larger proportion (approximately 86.4%) of the variance in the outcome compared to the main effects model.</span>
<span id="cb42-756"><a href="#cb42-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-757"><a href="#cb42-757" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practical Significance</span></span>
<span id="cb42-758"><a href="#cb42-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-759"><a href="#cb42-759" aria-hidden="true" tabindex="-1"></a>The findings have clear implications:</span>
<span id="cb42-760"><a href="#cb42-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-761"><a href="#cb42-761" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Workplace Wellness**: The significant negative association between Years Working ($\beta = -0.24$) and Quality of Life implies that long-term employment is associated with a cumulative decline in well-being. This highlights the practical need for workplace wellness initiatives and stress management programs for employees with longer tenure.</span>
<span id="cb42-762"><a href="#cb42-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-763"><a href="#cb42-763" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Integrated Health Interventions**: The Interaction term ($\beta = -1.6$) reveals that obesity not only lowers baseline Quality of Life but also dampens the positive effects of physical activity. Practically, this means "one size fits all" exercise recommendations may be less effective for obese individuals. Interventions should prioritize weight management alongside physical activity to unlock the steeper "Quality of Life return" observed in non-obese individuals.</span>
<span id="cb42-764"><a href="#cb42-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-765"><a href="#cb42-765" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Assumptions and Diagnostics</span></span>
<span id="cb42-766"><a href="#cb42-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-767"><a href="#cb42-767" aria-hidden="true" tabindex="-1"></a>Model checking revealed:</span>
<span id="cb42-768"><a href="#cb42-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-769"><a href="#cb42-769" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Linearity**: The Residuals vs Fitted plot shows a red smoothing line that is approximately horizontal and centered on zero, indicating that the linear relationship between the predictors and Quality of Life is correctly specified and the linearity assumption is satisfied. </span>
<span id="cb42-770"><a href="#cb42-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-771"><a href="#cb42-771" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Normality**: The Q-Q plot demonstrates that the standardized residuals align closely with the theoretical diagonal line across the entire range of quantiles. Although there are slight deviations at the extreme tails (specifically observations 156, 116, and 71), the overall pattern is straight and lacks significant skewness or heavy tails. This indicates that the residuals are approximately normally distributed, satisfying the normality assumption.</span>
<span id="cb42-772"><a href="#cb42-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-773"><a href="#cb42-773" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Homoscedasticity**: The Scale-Location plot reveals that the vertical spread of the standardized residuals remains relatively consistent across the range of fitted values. There is no evidence of divergence (expanding variance) or convergence (contracting variance) in the residuals as the predicted values increase. This stability in the error terms confirms that the assumption of homoscedasticity is satisfied.</span>
<span id="cb42-774"><a href="#cb42-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-775"><a href="#cb42-775" aria-hidden="true" tabindex="-1"></a><span class="fu">### Influential Observations and their impact on model prediction:</span></span>
<span id="cb42-776"><a href="#cb42-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-777"><a href="#cb42-777" aria-hidden="true" tabindex="-1"></a>The influential observations (127, 156, 72) introduce some noise but do not compromise the validity of the model's predictions. The model remains robust, and the relationships identified (such as the interaction between obesity and physical activity) hold true regardless of whether these points are included.</span>
<span id="cb42-778"><a href="#cb42-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-779"><a href="#cb42-779" aria-hidden="true" tabindex="-1"></a><span class="fu"># Prediction</span></span>
<span id="cb42-780"><a href="#cb42-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-781"><a href="#cb42-781" aria-hidden="true" tabindex="-1"></a><span class="fu">## New data simulation</span></span>
<span id="cb42-782"><a href="#cb42-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-783"><a href="#cb42-783" aria-hidden="true" tabindex="-1"></a>To visualize the model's predictions across a representative range of scenarios, we generated a new dataset (new_data) using a factorial grid that combines key values for years_working (0, 20, 40 years), phys_activity (0 to 10 in steps of 2), and both obesity levels.</span>
<span id="cb42-784"><a href="#cb42-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-787"><a href="#cb42-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-788"><a href="#cb42-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: new data simulation</span></span>
<span id="cb42-789"><a href="#cb42-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-790"><a href="#cb42-790" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb42-791"><a href="#cb42-791" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">20</span>),</span>
<span id="cb42-792"><a href="#cb42-792" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb42-793"><a href="#cb42-793" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>)</span>
<span id="cb42-794"><a href="#cb42-794" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-795"><a href="#cb42-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-796"><a href="#cb42-796" aria-hidden="true" tabindex="-1"></a>new_data <span class="sc">%&gt;%</span> <span class="fu">data.table</span>()</span>
<span id="cb42-797"><a href="#cb42-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-798"><a href="#cb42-798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-799"><a href="#cb42-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-800"><a href="#cb42-800" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fitted values </span></span>
<span id="cb42-801"><a href="#cb42-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-802"><a href="#cb42-802" aria-hidden="true" tabindex="-1"></a>We then applied the final regression model to the new dataset to compute the predicted Quality of Life scores and their corresponding 95% confidence intervals for each hypothetical scenario.</span>
<span id="cb42-803"><a href="#cb42-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-806"><a href="#cb42-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-807"><a href="#cb42-807" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Fitted values</span></span>
<span id="cb42-808"><a href="#cb42-808" aria-hidden="true" tabindex="-1"></a>predict<span class="ot">&lt;-</span> <span class="fu">augment</span> (mod_pa.obs, <span class="at">newdata =</span> new_data, <span class="at">interval=</span><span class="st">"confidence"</span>,<span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb42-809"><a href="#cb42-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-810"><a href="#cb42-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-811"><a href="#cb42-811" aria-hidden="true" tabindex="-1"></a>predict <span class="sc">%&gt;%</span></span>
<span id="cb42-812"><a href="#cb42-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-813"><a href="#cb42-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb42-814"><a href="#cb42-814" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted QOL on New Dataset"</span>,</span>
<span id="cb42-815"><a href="#cb42-815" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb42-816"><a href="#cb42-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-817"><a href="#cb42-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-818"><a href="#cb42-818" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction visualization</span></span>
<span id="cb42-819"><a href="#cb42-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-820"><a href="#cb42-820" aria-hidden="true" tabindex="-1"></a>Finally, we plotted the results to visualize how physical activity improves Quality of Life for obese versus non-obese individuals, separating the graphs by years of working to clearly compare the trends across different career lengths.</span>
<span id="cb42-821"><a href="#cb42-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-824"><a href="#cb42-824" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-825"><a href="#cb42-825" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predict, <span class="fu">aes</span>(<span class="at">x =</span> phys_activity, <span class="at">y =</span> .fitted, <span class="at">color =</span> obesity, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb42-826"><a href="#cb42-826" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add confidence intervals (Ribbons)</span></span>
<span id="cb42-827"><a href="#cb42-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb42-828"><a href="#cb42-828" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression lines</span></span>
<span id="cb42-829"><a href="#cb42-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-830"><a href="#cb42-830" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Facet by years_working to show the relationship across career lengths</span></span>
<span id="cb42-831"><a href="#cb42-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> years_working, <span class="at">labeller =</span> label_both) <span class="sc">+</span> </span>
<span id="cb42-832"><a href="#cb42-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span> </span>
<span id="cb42-833"><a href="#cb42-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb42-834"><a href="#cb42-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb42-835"><a href="#cb42-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-836"><a href="#cb42-836" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted Quality of Life by Physical Activity and Obesity Status"</span>,</span>
<span id="cb42-837"><a href="#cb42-837" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Stratified by Years Working (Model Predictions with 95% CIs)"</span>,</span>
<span id="cb42-838"><a href="#cb42-838" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted QOL Score (0-100)"</span>,</span>
<span id="cb42-839"><a href="#cb42-839" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Physical Activity Score (0-10)"</span>,</span>
<span id="cb42-840"><a href="#cb42-840" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Group"</span>,</span>
<span id="cb42-841"><a href="#cb42-841" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Group"</span></span>
<span id="cb42-842"><a href="#cb42-842" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-843"><a href="#cb42-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb42-844"><a href="#cb42-844" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb42-845"><a href="#cb42-845" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-846"><a href="#cb42-846" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb42-847"><a href="#cb42-847" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-848"><a href="#cb42-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-849"><a href="#cb42-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-850"><a href="#cb42-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-851"><a href="#cb42-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-852"><a href="#cb42-852" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb42-853"><a href="#cb42-853" aria-hidden="true" tabindex="-1"></a>Positive Effect of Physical Activity: Across all three panels (0, 20, and 40 years of working), there is a clear linear increase in Quality of Life (QOL) as physical activity scores rise from 0 to 10. This confirms that physical activity is beneficial for everyone, regardless of tenure or obesity status.</span>
<span id="cb42-854"><a href="#cb42-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-855"><a href="#cb42-855" aria-hidden="true" tabindex="-1"></a>Cumulative Negative Effect of Years Working: By comparing the panels from left to right, we observe a systematic downward shift in QOL scores.</span>
<span id="cb42-856"><a href="#cb42-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-857"><a href="#cb42-857" aria-hidden="true" tabindex="-1"></a>0 Years Working: The baseline QOL starts relatively high (around 40-50 for obese, 50-60 for non-obese).</span>
<span id="cb42-858"><a href="#cb42-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-859"><a href="#cb42-859" aria-hidden="true" tabindex="-1"></a>40 Years Working: The entire set of lines shifts down by approximately 10 points. This visualizes the cumulative burden of long-term employment, where individuals with high tenure have significantly lower well-being compared to new entrants, holding other factors constant.</span>
<span id="cb42-860"><a href="#cb42-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-861"><a href="#cb42-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-862"><a href="#cb42-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-863"><a href="#cb42-863" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb42-864"><a href="#cb42-864" aria-hidden="true" tabindex="-1"></a>Physical activity is beneficial for everyone, but the return on investment is higher for non-obese individuals. However, because obese individuals start with a lower baseline QOL, physical activity remains a crucial intervention, even if the rate of improvement is slower. The gap in QOL between the groups widens at higher activity levels. Public health interventions should prioritize physical activity for all, but distinct strategies are required for obese individuals. Since they face a "double burden" of lower baseline QOL and a slower return on investment from exercise, integrated approaches combining activity with weight management may be necessary to maximize their Quality of Life outcomes. </span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>
